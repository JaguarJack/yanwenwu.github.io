<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>JaguarJack&#39;s Blog</title>
  
  <subtitle>åšäººå‘¢æœ€é‡è¦çš„å°±æ˜¯å¼€å¿ƒ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://njphper.com/"/>
  <updated>2020-02-01T05:05:45.322Z</updated>
  <id>https://njphper.com/</id>
  
  <author>
    <name>JaguarJack</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Laravel éå¸¸æœ‰ç”¨å´ä¸å¸¸ç”¨çš„æ–¹æ³•è®°å½•</title>
    <link href="https://njphper.com/posts/laravel-userfule-method/"/>
    <id>https://njphper.com/posts/laravel-userfule-method/</id>
    <published>2019-05-14T22:11:59.000Z</published>
    <updated>2020-02-01T05:05:45.322Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡åšå®¢è®°å½•ä¸€äº› Laravel æ¡†æ¶ä¸€äº›ä¸å¸¸ç”¨ä½†éå¸¸å®ç”¨çš„æ–¹æ³•ã€‚æˆ–è€…ä¸€äº›éå¸¸æœ‰ç”¨çš„å°æŠ€å·§ï¼Œå¯ä»¥æ˜¾è‘—æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚å¹¶ä¸”è®°å½•ä¸€äº›éš¾ä»¥å‘ç°çš„æŠ€å·§æ€§çš„ä½¿ç”¨ã€‚</p><a id="more"></a><h2 id="è·å–è¡¨ç»“æ„ä¿¡æ¯"><a href="#è·å–è¡¨ç»“æ„ä¿¡æ¯" class="headerlink" title="è·å–è¡¨ç»“æ„ä¿¡æ¯"></a>è·å–è¡¨ç»“æ„ä¿¡æ¯</h2><p>ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äº <code>Laravel</code> è·å–è¡¨ä¿¡æ¯çš„æ–‡ç« ï¼Œå¾ˆå¤šéƒ½æ˜¯è¿™æ ·çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ•°æ®åº“æ‰€æœ‰è¡¨ä¿¡æ¯</span></span><br><span class="line">DB::select(<span class="string">'show tables'</span>)</span><br><span class="line"><span class="comment">// è·å–è¡¨ column ä¿¡æ¯</span></span><br><span class="line">Db::select(<span class="string">'show full columns from  $table'</span>)</span><br><span class="line"><span class="comment">// è·å–è¡¨ä¿¡æ¯</span></span><br><span class="line">DB::select(<span class="string">'show table status'</span>))</span><br></pre></td></tr></table></figure><p>å½“ç„¶è¿™æ ·æ˜¯å¯ä»¥è·å–åˆ°çš„ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå…³é”®è¿™æ ·è®©ä»£ç çœ‹èµ·æ¥æœ‰ç‚¹éš¾å—ï¼Œå…¶å® <code>Laravel</code> æä¾›äº†ä¸€ç³»åˆ—è¿™æ ·çš„æ“ä½œã€‚ä¸‹é¢æ¥æä¾›è¯¥æ¼”ç¤º:</p><h3 id="è·å–æ‰€æœ‰è¡¨"><a href="#è·å–æ‰€æœ‰è¡¨" class="headerlink" title="è·å–æ‰€æœ‰è¡¨"></a>è·å–æ‰€æœ‰è¡¨</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\Illuminate\Support\Facades\DB::connection()-&gt;getDoctrineSchemaManager()-&gt;listTableNames())</span><br></pre></td></tr></table></figure><h3 id="è·å–è¡¨æ‰€æœ‰-Column-å­—æ®µ"><a href="#è·å–è¡¨æ‰€æœ‰-Column-å­—æ®µ" class="headerlink" title="è·å–è¡¨æ‰€æœ‰ Column å­—æ®µ"></a>è·å–è¡¨æ‰€æœ‰ Column å­—æ®µ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\Illuminate\Support\Facades\Schema::getColumnListing(<span class="string">'table'</span>))</span><br></pre></td></tr></table></figure><h3 id="è·å–è¡¨å•ä¸ªå­—æ®µçš„ä¿¡æ¯"><a href="#è·å–è¡¨å•ä¸ªå­—æ®µçš„ä¿¡æ¯" class="headerlink" title="è·å–è¡¨å•ä¸ªå­—æ®µçš„ä¿¡æ¯"></a>è·å–è¡¨å•ä¸ªå­—æ®µçš„ä¿¡æ¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å•ä¸ªå­—æ®µä¿¡æ¯</span></span><br><span class="line">$field = \Illuminate\Support\Facades\DB::connection()-&gt;getDoctrineColumn(<span class="string">'table'</span>, <span class="string">'field_name'</span>)</span><br><span class="line">$field-&gt;getComment(); <span class="comment">// è·å–æ³¨é‡Š</span></span><br><span class="line">$field-&gt;getType(); <span class="comment">// è·å–ç±»å‹</span></span><br></pre></td></tr></table></figure><h3 id="è·å–è¡¨ä¿¡æ¯"><a href="#è·å–è¡¨ä¿¡æ¯" class="headerlink" title="è·å–è¡¨ä¿¡æ¯"></a>è·å–è¡¨ä¿¡æ¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\Illuminate\Support\Facades\DB::connection()-&gt;getDoctrineSchemaManager()-&gt;listTableDetails(<span class="string">'table'</span>)-&gt;getOptions());</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬ç¯‡åšå®¢è®°å½•ä¸€äº› Laravel æ¡†æ¶ä¸€äº›ä¸å¸¸ç”¨ä½†éå¸¸å®ç”¨çš„æ–¹æ³•ã€‚æˆ–è€…ä¸€äº›éå¸¸æœ‰ç”¨çš„å°æŠ€å·§ï¼Œå¯ä»¥æ˜¾è‘—æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚å¹¶ä¸”è®°å½•ä¸€äº›éš¾ä»¥å‘ç°çš„æŠ€å·§æ€§çš„ä½¿ç”¨ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="laravel" scheme="https://njphper.com/tags/laravel/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³ IE/Edge å¯¼å‡º Excel ä¸­æ–‡æ–‡ä»¶åä¹±ç </title>
    <link href="https://njphper.com/posts/ie-urlencode/"/>
    <id>https://njphper.com/posts/ie-urlencode/</id>
    <published>2019-05-08T22:29:03.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>é¡¹ç›®ä¸­å¯¼å‡º Excel çš„æ—¶å€™ï¼Œç”±äºæ–‡ä»¶åè®¾ç½®çš„æ˜¯ä¸­æ–‡å­—ç¬¦ä¸²ï¼Œåœ¨ Google æµè§ˆå™¨æ˜¯æ­£å¸¸çš„å¯¼å‡ºï¼Œæ–‡ä»¶åä¸ä¼šå‡ºç°ä¹±ç ï¼Œä½†æ˜¯åœ¨ Edge/IE æµè§ˆå™¨ä¸‹å°±ä¼šå‡ºç°ä¹±ç çš„æƒ…å†µã€‚Google ä¸€ä¸‹ä½ ä¼šæœåˆ°å¾ˆå¤šç­”æ¡ˆï¼Œå½“ç„¶å¾ˆå¤šéƒ½æ˜¯ä¸é è°±çš„ï¼Œæœ€åé—®é¢˜æ˜¯è§£å†³äº†ã€‚ä½†æ˜¯é‡åˆ°è¿™ä¸ªé—®é¢˜çš„äººå¹¶æ²¡æœ‰è¯´æ˜ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œç©¶å…¶æ ¹æºï¼Œçœ‹åšå®¢çš„æ„æ€åº”è¯¥æ˜¯ä»å¢™å¤–æ‰¾åˆ°çš„ç­”æ¡ˆã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>è§£å†³è¿™ä¸ªå¾ˆç®€å•ï¼Œä½†æ˜¯éœ€è¦åšçš„å°±æ˜¯å»äº†è§£ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œä¸‹é¢æ˜¯è§£å†³åŠæ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encodeFileName</span><span class="params">($filename)</span> </span>&#123;</span><br><span class="line">        $ua = strtolower($_SERVER(<span class="string">'HTTP_USER_AGENT'</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºIEæˆ–Edgeæµè§ˆå™¨</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/msie/'</span>, $ua) || preg_match(<span class="string">'/edge/'</span>, $ua)) &#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ urlencode å¯¹æ–‡ä»¶åè¿›è¡Œé‡æ–°ç¼–ç </span></span><br><span class="line">            <span class="keyword">return</span> str_replace(<span class="string">'+'</span>, <span class="string">'%20'</span>, urlencode($filename));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $filename;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®é—®é¢˜è§£å†³æ˜¯å¾ˆç®€å•çš„ï¼Œä½¿ç”¨<code>urlencode</code>å‡½æ•°å°±å¯ä»¥äº†ã€‚ä¸‹é¢æ…¢æ…¢é“æ¥ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h2&gt;&lt;p&gt;é¡¹ç›®ä¸­å¯¼å‡º Excel çš„æ—¶å€™ï¼Œç”±äºæ–‡ä»¶åè®¾ç½®çš„æ˜¯ä¸­æ–‡å­—ç¬¦ä¸²ï¼Œåœ¨ Google æµè§ˆå™¨æ˜¯æ­£å¸¸çš„å¯¼å‡ºï¼Œæ–‡ä»¶åä¸ä¼šå‡ºç°ä¹±ç ï¼Œä½†æ˜¯åœ¨ Edge/I
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="excel" scheme="https://njphper.com/tags/excel/"/>
    
  </entry>
  
  <entry>
    <title>Nginx å­¦ä¹ ç¬”è®°</title>
    <link href="https://njphper.com/posts/nginx-conf/"/>
    <id>https://njphper.com/posts/nginx-conf/</id>
    <published>2019-05-08T08:06:54.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½• Nginx ä¸€äº›å­¦ä¹ å’Œç¬”è®°ã€‚è¿˜æœ‰é‡åˆ°çš„é—®é¢˜ã€‚</p><h2 id="nginx-conf-æ–‡ä»¶ç»“æ„"><a href="#nginx-conf-æ–‡ä»¶ç»“æ„" class="headerlink" title="nginx.conf æ–‡ä»¶ç»“æ„"></a>nginx.conf æ–‡ä»¶ç»“æ„</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">... # å…¨å±€æ¨¡å—</span><br><span class="line"></span><br><span class="line"># events æ¨¡å—</span><br><span class="line">events &#123;</span><br><span class="line">  ....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># httpå—</span><br><span class="line">http &#123;</span><br><span class="line">    # http å…¨å±€å—</span><br><span class="line">    ...</span><br><span class="line">    # server å—</span><br><span class="line">    server</span><br><span class="line">    &#123;</span><br><span class="line">        # server å…¨å±€å—</span><br><span class="line">        ...</span><br><span class="line">        # location å—</span><br><span class="line">        location [PATTERN]</span><br><span class="line">        &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±ä¸Šé¢ä»¥å¤§æ‹¬å·ä¸ºåˆ†å‰² Nginx.conf å¯åˆ†ä¸ºä¸‰å¤§å—<code>å…¨å±€å—</code>, <code>events</code>, <code>http</code>ã€‚å…¶ä¸­ http æ¨¡å—é‡Œé¢æœ‰åˆ†ä¸º <code>å…¨å±€å—</code>, <code>server</code> ä¸¤ä¸ªå—ã€‚server å¯ä»¥æœ‰å¤šä¸ªã€‚server é‡Œé¢åˆåˆ†ä¸º <code>å…¨å±€</code> å’Œ <code>location</code> ä¸¤ä¸ªæ¨¡å—ã€‚location ä¹Ÿæ˜¯å¯ä»¥æœ‰å¤šä¸ªã€‚åœ¨ Nginx ä½¿ç”¨æ–¹é¢ï¼Œå¤§å¤šæ•°éƒ½ä½“ç°åœ¨é…ç½®æ–‡ä»¶ã€‚åº”ç”¨æ–¹é¢ä¹Ÿä½“ç°åœ¨é…ç½®äº†ï¼Œå½“ç„¶ Nginx é…ç½®æ˜¯å¾ˆä¸°å¯Œå¤šæ ·çš„ã€‚</p><h3 id="å…¨å±€æ¨¡å—"><a href="#å…¨å±€æ¨¡å—" class="headerlink" title="å…¨å±€æ¨¡å—"></a>å…¨å±€æ¨¡å—</h3><p>å…¨å±€æ¨¡å—æ˜¯é»˜è®¤é…ç½®æ–‡ä»¶å¼€å§‹åˆ° events è¿™ä¸€å—å†…å®¹ï¼Œä¸»è¦è®¾ç½®ä¸€äº› Nginx è¿è¡ŒæŒ‡ä»¤ï¼Œé€šå¸¸åŒ…æ‹¬ Nginx è¿è¡Œçš„ç”¨æˆ·/ç»„ï¼Œworker proccess æ•°ï¼ŒMaster è¿›ç¨‹ PID å­˜å‚¨è·¯å¾„ï¼Œæ—¥å¿—çš„å­˜æ”¾è·¯å¾„ä»¥åŠé…ç½®æ–‡ä»¶çš„å¼•å…¥ç­‰ç­‰ã€‚</p><h3 id="events-æ¨¡å—"><a href="#events-æ¨¡å—" class="headerlink" title="events æ¨¡å—"></a>events æ¨¡å—</h3><p>events æ¨¡å—ä¸»è¦æ˜¯ Nginx ä¸ç”¨æˆ·é“¾æ¥çš„è®¾ç½®ã€‚åŒ…æ‹¬è®¾ç½®äº‹ä»¶é©±åŠ¨æ¨¡å‹å’Œæ¯ä¸ª worker proccess å…è®¸çš„æœ€å¤§é“¾æ¥æ•°ç›®ï¼Œè¿™éƒ¨åˆ†è®¾ç½®å¯¹ Nginx çš„æ€§èƒ½å½±å“å¾ˆå¤§ï¼Œä¸»è¦ä½“ç°äº‹ä»¶é©±åŠ¨ä¸Šã€‚</p><h3 id="Http-æ¨¡å—"><a href="#Http-æ¨¡å—" class="headerlink" title="Http æ¨¡å—"></a>Http æ¨¡å—</h3><p>Http æ¨¡å—æ˜¯ Nginx æœåŠ¡çš„é‡è¦éƒ¨åˆ†ï¼Œä»£ç†ï¼Œç¼“å­˜å’Œæ—¥å¿—ç­‰ç»å¤§æ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—éƒ½æ˜¯æ”¾åœ¨è¿™ä¸ªæ¨¡å—ä¸­ã€‚</p><h4 id="Httpå…¨å±€å—"><a href="#Httpå…¨å±€å—" class="headerlink" title="Httpå…¨å±€å—"></a>Httpå…¨å±€å—</h4><p>Http å…¨å±€å—ä¸­é…ç½®çš„æŒ‡ä»¤åŒ…æ‹¬æ–‡ä»¶å¼•å…¥ï¼ŒMIME-Type å®šä¹‰ï¼Œæ—¥å¿—è‡ªå®šä¹‰ï¼Œæ˜¯å¦ä½¿ç”¨ sendfile ä¼ è¾“æ–‡ä»¶ï¼Œé“¾æ¥è¶…æ—¶æ—¶é—´ï¼Œä½†é“¾æ¥è¯·æ±‚ä¸Šé™ç­‰ã€‚</p><h4 id="Server-æ¨¡å—"><a href="#Server-æ¨¡å—" class="headerlink" title="Server æ¨¡å—"></a>Server æ¨¡å—</h4><p>Http å—ä¸­å¯ä»¥åŒ…å«å¤šä¸ª Server æ¨¡å—ï¼Œæ¯ä¸ª Server æ¨¡å—å¯¹åº”ç€ä¸€å°è™šæ‹Ÿæœºï¼Œå¯ä»¥ä¸ºå¤šå°ä¸»æœºæä¾›æœåŠ¡ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ä¸€ç»„é€»è¾‘ä¸Šå…³ç³»ã€‚</p><h5 id="Server-å…¨å±€æ¨¡å—"><a href="#Server-å…¨å±€æ¨¡å—" class="headerlink" title="Server å…¨å±€æ¨¡å—"></a>Server å…¨å±€æ¨¡å—</h5><p>Server å…¨å±€æ¨¡å—æä¾›ä¸€äº›åŸºç¡€åŠŸèƒ½ï¼Œ åŒ…æ‹¬è™šæ‹Ÿæœºçš„ç›‘å¬é…ç½®å’Œé…ç½®è™šæ‹Ÿæœºçš„åç§°æˆ–è€… IP åœ°å€ã€‚</p><h5 id="Location-æ¨¡å—"><a href="#Location-æ¨¡å—" class="headerlink" title="Location æ¨¡å—"></a>Location æ¨¡å—</h5><p>Server æ¨¡å—çš„å¤§å¤šæ•°åŠŸèƒ½éƒ½åœ¨ Location ä¸­å®ç°ï¼Œå…¶å®æ•´ä¸ª Nginx é…ç½®é‡è¦çš„é…ç½®éƒ½åœ¨è¿™å—ï¼Œlocation ä¸»è¦å¯¹ Nginx çš„æ¥æ”¶çš„ uri è¿›è¡ŒåŒ¹é…ï¼Œå¯¹ç‰¹å®šçš„è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œåœ°å€å®šå‘ï¼Œæ•°æ®ç¼“å­˜å’Œåº”ç­”ç­‰æ§åˆ¶åŠŸèƒ½éƒ½æ˜¯åœ¨è¿™éƒ¨åˆ†å®ç°ï¼Œç¬¬ä¸‰æ–¹æ¨¡å—ä¹Ÿæä¾›äº†è¿™å—çš„åŠŸèƒ½</p><h2 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h2><p>ç”¨æµç¨‹å›¾è¡¨ç¤ºå¯èƒ½æ›´åŠ æ˜æ˜¾ï¼Œæ¥çœ‹ä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">graph LR;</span><br><span class="line">    Nginx.conf--&gt;id1&#123;å…¨å±€æ¨¡å—&#125;;</span><br><span class="line">    Nginx.conf--&gt;id2&#123;Eventæ¨¡å—&#125;;</span><br><span class="line">    Nginx.conf--&gt;id3&#123;Httpæ¨¡å—&#125;;</span><br><span class="line">    id1&#123;å…¨å±€æ¨¡å—&#125;--&gt;è¿è¡Œç”¨æˆ·ç»„;</span><br><span class="line">    id1&#123;å…¨å±€æ¨¡å—&#125;--&gt;workerProccessæ•°ç›®;</span><br><span class="line">    id1&#123;å…¨å±€æ¨¡å—&#125;--&gt;MasterPIDå­˜å‚¨è·¯å¾„;</span><br><span class="line">    id1&#123;å…¨å±€æ¨¡å—&#125;--&gt;æ—¥å¿—å­˜æ”¾è·¯å¾„;</span><br><span class="line">    id1&#123;å…¨å±€æ¨¡å—&#125;--&gt;é…ç½®æ–‡ä»¶å¼•å…¥;</span><br><span class="line">    id2&#123;Eventæ¨¡å—&#125;--&gt;äº‹ä»¶é©±åŠ¨æ¨¡å‹;</span><br><span class="line">    id2&#123;Eventæ¨¡å—&#125;--&gt;å…è®¸æœ€å¤§é“¾æ¥æ•°ç›®;</span><br><span class="line">    id3&#123;Httpæ¨¡å—&#125;--&gt;Httpå…¨å±€æ¨¡å—;</span><br><span class="line">    Httpå…¨å±€æ¨¡å—--&gt;æ–‡ä»¶å¼•å…¥;</span><br><span class="line">    Httpå…¨å±€æ¨¡å—--&gt;MIME-Typeå®šä¹‰;</span><br><span class="line">    Httpå…¨å±€æ¨¡å—--&gt;è‡ªå®šä¹‰æ—¥å¿—;</span><br><span class="line">    Httpå…¨å±€æ¨¡å—--&gt;sendfileä¼ è¾“æ–‡ä»¶;</span><br><span class="line">    Httpå…¨å±€æ¨¡å—--&gt;é“¾æ¥è¶…æ—¶;</span><br><span class="line">    Httpå…¨å±€æ¨¡å—--&gt;é“¾æ¥è¯·æ±‚ä¸Šé™;</span><br><span class="line">    id3&#123;Httpæ¨¡å—&#125;--&gt;Serveræ¨¡å—;</span><br><span class="line">    Serveræ¨¡å—--&gt;Serverå…¨å±€æ¨¡å—;</span><br><span class="line">    Serverå…¨å±€æ¨¡å—--&gt;è™šæ‹Ÿæœºçš„ç›‘å¬;</span><br><span class="line">    Serverå…¨å±€æ¨¡å—--&gt;é…ç½®è™šæ‹Ÿæœºåç§°æˆ–è€…IPåœ°å€;</span><br><span class="line">    Serveræ¨¡å—--&gt;Locationæ¨¡å—;</span><br><span class="line">    Locationæ¨¡å—--&gt;è¯·æ±‚å¤„ç†; </span><br><span class="line">    Locationæ¨¡å—--&gt;åœ°å€å®šå‘;</span><br><span class="line">    Locationæ¨¡å—--&gt;æ•°æ®ç¼“å­˜; </span><br><span class="line">    Locationæ¨¡å—--&gt;è¯·æ±‚åº”ç­”; </span><br><span class="line">    Locationæ¨¡å—--&gt;åå‘ä»£ç†;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½• Nginx ä¸€äº›å­¦ä¹ å’Œç¬”è®°ã€‚è¿˜æœ‰é‡åˆ°çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&quot;nginx-conf-æ–‡ä»¶ç»“æ„&quot;&gt;&lt;a href=&quot;#nginx-conf-æ–‡ä»¶ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;nginx.conf æ–‡ä»¶ç»“æ„&quot;&gt;&lt;/a&gt;ng
      
    
    </summary>
    
    
      <category term="æœåŠ¡å™¨è¿ç»´" scheme="https://njphper.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="æœåŠ¡å™¨" scheme="https://njphper.com/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="nginx" scheme="https://njphper.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>leetcode ç®€å•é¢˜ï¼ˆä¸€ï¼‰</title>
    <link href="https://njphper.com/posts/leetcode-easy-one/"/>
    <id>https://njphper.com/posts/leetcode-easy-one/</id>
    <published>2019-05-07T15:02:42.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜ä¸€"><a href="#é—®é¢˜ä¸€" class="headerlink" title="é—®é¢˜ä¸€"></a>é—®é¢˜ä¸€</h2><p>Given an array of integers, return indices of the two numbers such that they add up to a specific target.</p><p>You may assume that each input would have exactly one solution, and you may not use the same element twice.</p><p>Example:</p><blockquote><p>Given nums = [2, 7, 11, 15], target = 9,</p></blockquote><p>Because nums[0] + nums[1] = 2 + 7 = 9,<br>return [0, 1].</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>ä¸Šæ¥ä¸ç”±åˆ†è¯´ï¼Œå…ˆæ¥ä¸€ä¸ª For å†è¯´ğŸ˜„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sumtotarget</span><span class="params">(nums []<span class="keyword">int</span>, target <span class="keyword">int</span>)</span> []<span class="title">int</span></span> &#123;</span><br><span class="line"> l := <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> nums &#123;</span><br><span class="line">r := target - v</span><br><span class="line"><span class="keyword">for</span> j:=i+<span class="number">1</span>; j &lt; l; j++ &#123;</span><br><span class="line"><span class="keyword">if</span> r == nums[j] &#123;</span><br><span class="line"><span class="keyword">return</span> []<span class="keyword">int</span>&#123;i, j&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> []<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œç¾æˆåŠŸè¿è¡Œäº†ï¼Œå“ˆå“ˆã€‚æƒ³æƒ³è¿™æ ·ä¸è¡Œå•Š O(n^2)ã€‚ç„¶åä»”ç»†æƒ³äº†ä¸€ä¸‹ï¼Œå¯ä»¥åˆ©ç”¨ map çš„ç‰¹æ€§æ¥å¤„ç†ï¼Œå°±æœ‰ä¸‹é¢è¿™ä¸€æ®µä»£ç ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sumtotarget</span><span class="params">(nums []<span class="keyword">int</span>, target <span class="keyword">int</span>)</span> []<span class="title">int</span></span> &#123;</span><br><span class="line">numbers := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>)</span><br><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> nums &#123;</span><br><span class="line">j, ok := numbers[v]</span><br><span class="line">numbers[target - v] = i</span><br><span class="line"><span class="keyword">if</span> ok &#123;</span><br><span class="line"><span class="keyword">return</span> []<span class="keyword">int</span>&#123;j, i&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> []<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€åˆ·ï¼Œç®€å•é¢˜éƒ½æ‰›ä¸ä½äº†ã€‚åªèƒ½æ…¢æ…¢æ¥äº†</p><h2 id="é—®é¢˜äºŒ"><a href="#é—®é¢˜äºŒ" class="headerlink" title="é—®é¢˜äºŒ"></a>é—®é¢˜äºŒ</h2><p>Given a 32-bit signed integer, reverse digits of an integer.</p><p>Example 1:</p><blockquote><p>Input: 123<br>Output: 321</p></blockquote><p>Example 2:</p><blockquote><p>Input: -123<br>Output: -321</p></blockquote><p>Example 3:</p><blockquote><p>Input: 120<br>Output: 21</p></blockquote><p>Note:<br>Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: [âˆ’231,  231 âˆ’ 1]. For the purpose of this problem, assume that your function returns 0 when the reversed integer overflows.</p><h2 id="è§£å†³-1"><a href="#è§£å†³-1" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ³¨æ„çš„å°±æ˜¯ int32 æº¢å‡ºçš„é—®é¢˜äº†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reverse</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> num <span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span>  &#123;</span><br><span class="line">n := x % <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> x == <span class="number">0</span> &amp;&amp; n == <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">x = x / <span class="number">10</span></span><br><span class="line">num = num * <span class="number">10</span> + n</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// -2147483648 åˆ° 2147483647</span></span><br><span class="line"><span class="keyword">if</span> num &gt; math.MaxInt32 || num &lt; math.MinInt32 &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>  num</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜ä¸‰"><a href="#é—®é¢˜ä¸‰" class="headerlink" title="é—®é¢˜ä¸‰"></a>é—®é¢˜ä¸‰</h2><p>Determine whether an integer is a palindrome. An integer is a palindrome when it reads the same backward as forward.</p><p>Example 1:</p><blockquote><p>Input: 121<br>Output: true</p></blockquote><p>Example 2:</p><blockquote><p>Input: -121<br>Output: false</p></blockquote><p>Explanation: From left to right, it reads -121. From right to left, it becomes 121-. Therefore it is not a palindrome.<br>Example 3:</p><blockquote><p>Input: 10<br>Output: false</p></blockquote><p>Explanation: Reads 01 from right to left. Therefore it is not a palindrome.</p><h2 id="è§£å†³-2"><a href="#è§£å†³-2" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>è¿™é“é¢˜æ•°å­—å›æ–‡ï¼Œå…¶å®å’Œä¸Šé¢çš„åè½¬æ˜¯ä¸€ä¸ªé“ç†ï¼Œå°±æ˜¯æ¯”è¾ƒåè½¬åçš„æ•°å­—å’Œå®å‚æ˜¯å¦ç›¸ç­‰å°±å¯ä»¥äº†ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isPalindrome</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> x &lt; <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> num <span class="keyword">int</span></span><br><span class="line">cache := x</span><br><span class="line"><span class="keyword">for</span>  &#123;</span><br><span class="line">n := x % <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x == <span class="number">0</span> &amp;&amp; n == <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">x = x / <span class="number">10</span></span><br><span class="line">num = num * <span class="number">10</span> + n</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> cache == num &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é—®é¢˜ä¸€&quot;&gt;&lt;a href=&quot;#é—®é¢˜ä¸€&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜ä¸€&quot;&gt;&lt;/a&gt;é—®é¢˜ä¸€&lt;/h2&gt;&lt;p&gt;Given an array of integers, return indices of the two numbers such
      
    
    </summary>
    
    
      <category term="leetcode" scheme="https://njphper.com/categories/leetcode/"/>
    
    
      <category term="leetcode" scheme="https://njphper.com/tags/leetcode/"/>
    
  </entry>
  
  <entry>
    <title>Hexo Next ä¸»é¢˜å¢åŠ æ–°çš„ç¬¬ä¸‰æ–¹è¯„è®ºç³»ç»Ÿ utterance</title>
    <link href="https://njphper.com/posts/hexo-add-comment/"/>
    <id>https://njphper.com/posts/hexo-add-comment/</id>
    <published>2019-05-06T14:00:19.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>åšå®¢æœ€è¿‘åˆ‡æ¢åˆ°äº† <code>hexo</code> åšå®¢, ç›®å‰ç”¨èµ·æ¥æ„Ÿè§‰å¾ˆæ–¹ä¾¿ã€‚å¾ˆå–œæ¬¢ markdown å†™ä½œã€‚å½“ç„¶åˆ©ç”¨ Github Pages ä¹Ÿçœä¸‹äº†ä¸€ç¬”è´¹ç”¨ï¼ŒæŸå¥—è·¯äº‘çš„å¥—è·¯ä»¤äººæ„Ÿåˆ°æ¶å¿ƒã€‚è¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚ä¸ºä»€ä¹ˆè¦æ¢è¯„è®ºå‘¢ï¼Ÿå› ä¸ºæˆ‘ä½¿ç”¨çš„ <code>next</code> ä¸»é¢˜çš„è¯„è®ºéƒ½ä¸å¤ªåˆæˆ‘çš„å¿ƒæ„ï¼ŒDisqus å¾ˆå¥½ï¼Œä½†æ˜¯å¹¿å‘Šå¤ªå¤šï¼Œå…¶ä»–ä»¿ git çš„è¯„è®ºæ€»è§‰å¾—åˆ«æ‰­ï¼Œäºæ˜¯æˆ‘ä¹Ÿç¿»äº†æ‰¾æ‰¾çœ‹ï¼Œå‘ç°äº† <code>utterance</code>ï¼Œè§‰å¾—æŒºä¸é”™çš„ï¼Œç®€æ´é£æ ¼ä¹Ÿä¸ç¼ºå¤±ã€‚æ‰€ä»¥å°±æ‰“ç®—æ¢è¿™ä¸ªäº†ã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>hexo çš„ä¸»é¢˜æ”¹èµ·æ¥è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä»é…ç½®å¼€å§‹ï¼Œç„¶åæ·»åŠ ä¸€å°æ®µçš„æ¨¡å—ä»£ç å°±å¯ä»¥äº†ã€‚æ ‡ç­¾ä¹Ÿå¯ä»¥ä»¿ç…§å…¶ä»–æ–‡ä»¶ï¼ŒSo Easyï¼å¼€å§‹åŠ¨æ‰‹å§ã€‚åœ¨è¿™ä¹‹å‰éœ€è¦åˆ° <a href="https://github.com/apps/utterances" target="_blank" rel="noopener">utterances app</a> ç”³è¯·ä¸€ä¸‹ï¼Œè¿™æ · utterances æ‰æœ‰æƒé™è®¿é—®ä½ çš„ä»“åº“ã€‚</p><h3 id="æ·»åŠ é…ç½®"><a href="#æ·»åŠ é…ç½®" class="headerlink" title="æ·»åŠ é…ç½®"></a>æ·»åŠ é…ç½®</h3><p>æ‰¾åˆ° Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ _config.ymlï¼Œé…ç½®éšä¾¿ä½ æ·»åŠ åˆ°å“ªé‡Œã€‚ä½ å¯ä»¥æ”¾åœ¨æ–‡ä»¶æœ«å°¾æˆ–è€…å¯ä»¥å’Œå…¶ä»–è¯„è®ºæ¨¡å—é…ç½®æ”¾åœ¨ä¸€å—ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">utterance:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  repo: #ä»“åº“åå­—</span><br><span class="line">  theme: #ä¸»é¢˜</span><br><span class="line">  issue-term: #æ˜ å°„é…ç½®</span><br></pre></td></tr></table></figure><p>è¯„è®ºä¸»é¢˜çš„ theme é€‰é¡¹å¦‚ä¸‹:</p><blockquote><ul><li>github-light</li></ul></blockquote><ul><li>github-dark</li><li>github-dark-orange</li><li>icy-dark</li><li>dark-blue</li><li>photon-dark</li></ul><p>è¯„è®º issue-term æ˜ å°„é…ç½®é€‰é¡¹å¦‚ä¸‹ï¼š</p><blockquote><ul><li>pathname</li></ul></blockquote><ul><li>url</li><li>title</li><li>og:title</li><li>issue-number</li><li>specific-term</li></ul><h3 id="å¼•å…¥-Utterance-æ’ä»¶"><a href="#å¼•å…¥-Utterance-æ’ä»¶" class="headerlink" title="å¼•å…¥ Utterance æ’ä»¶"></a>å¼•å…¥ Utterance æ’ä»¶</h3><p>åœ¨ <code>_third-party\comments</code> æ–‡ä»¶å¤¹ä¸‹åˆ›å»º <code>utterance.swig</code> æ–‡ä»¶ã€‚å†™å…¥ä»£ç å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">    (function() &#123;</span><br><span class="line">        &#x2F;&#x2F; åŒ¿åå‡½æ•°ï¼Œé˜²æ­¢æ±¡æŸ“å…¨å±€å˜é‡</span><br><span class="line">        var utterances &#x3D; document.createElement(&#39;script&#39;);</span><br><span class="line">        utterances.type &#x3D; &#39;text&#x2F;javascript&#39;;</span><br><span class="line">        utterances.async &#x3D; true;</span><br><span class="line">        utterances.setAttribute(&#39;issue-term&#39;,&#39;&#123;&#123; theme.utterance.issue-item &#125;&#125;&#39;)</span><br><span class="line">        utterances.setAttribute(&#39;theme&#39;,&#39;&#123;&#123; themm.utterance.theme &#125;&#125;&#39;)</span><br><span class="line">        utterances.setAttribute(&#39;repo&#39;,&#39;&#123;&#123; theme.utterance.repo &#125;&#125;&#39;)</span><br><span class="line">        utterances.crossorigin &#x3D; &#39;anonymous&#39;;</span><br><span class="line">        utterances.src &#x3D; &#39;https:&#x2F;&#x2F;utteranc.es&#x2F;client.js&#39;;</span><br><span class="line">        &#x2F;&#x2F; content æ˜¯è¦æ’å…¥è¯„è®ºçš„åœ°æ–¹</span><br><span class="line">        document.getElementById(&#39;gitment-container&#39;).appendChild(utterances);</span><br><span class="line">    &#125;)();</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h3 id="å¢åŠ -comment-æ ·å¼"><a href="#å¢åŠ -comment-æ ·å¼" class="headerlink" title="å¢åŠ  comment æ ·å¼"></a>å¢åŠ  comment æ ·å¼</h3><p>æ‰¾åˆ° <code>_partials\comments.swig</code> ç„¶åå¢åŠ ä¸‹é¢ä»£ç :</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elif theme.utterance.enable %&#125;</span><br><span class="line">     &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"comments"</span> id=<span class="string">"comments"</span>&gt;</span><br><span class="line">        &lt;div id=<span class="string">"gitment-container"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br></pre></td></tr></table></figure><p>è¿˜éœ€è¦åœ¨ <code>_third-party\comments\index.swig</code> æ·»åŠ å¦‚ä¸‹ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elif theme.utterance.enable %&#125;</span><br><span class="line">    &#123;% include <span class="string">'utterance.swig'</span> %&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªé…ç½®è¿‡ç¨‹ã€‚å¦‚æœæœ‰ä»»ä½•é—®é¢˜å¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h2&gt;&lt;p&gt;åšå®¢æœ€è¿‘åˆ‡æ¢åˆ°äº† &lt;code&gt;hexo&lt;/code&gt; åšå®¢, ç›®å‰ç”¨èµ·æ¥æ„Ÿè§‰å¾ˆæ–¹ä¾¿ã€‚å¾ˆå–œæ¬¢ markdown å†™ä½œã€‚å½“ç„¶åˆ©ç”¨ Github 
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="hexo" scheme="https://njphper.com/tags/hexo/"/>
    
      <category term="next" scheme="https://njphper.com/tags/next/"/>
    
      <category term="è¯„è®º" scheme="https://njphper.com/tags/%E8%AF%84%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>Laravel ä¿®æ”¹ dingo å¼‚å¸¸å¤„ç†é»˜è®¤ Http Code</title>
    <link href="https://njphper.com/posts/dingo-exception/"/>
    <id>https://njphper.com/posts/dingo-exception/</id>
    <published>2019-05-05T10:51:47.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>å…¬å¸éœ€è¦å°†è€é¡¹ç›®è¿ç§», ç”±äºä¹‹å‰çš„é”™è¯¯è¿”å›éƒ½æ˜¯ä¸è§„èŒƒçš„, å¯¹äºé”™è¯¯å¤„ç†éƒ½æ˜¯ç›´æ¥è¿”å› <strong>200</strong> http codeã€‚å¤§é‡çš„ä½¿ç”¨è¿™æ ·çš„è¿”å›ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response()-&gt;json(<span class="number">200</span>, [<span class="string">'msg'</span>=&gt;$msg])</span><br></pre></td></tr></table></figure><p>å·²ç»æ²¡æœ‰åŠæ³•æ›´æ”¹äº†, å®¢æˆ·ç«¯éƒ½æ˜¯æ ¹æ®æ¥å£çš„çš„ä¸šåŠ¡ä»£ç  <code>code</code> æ¥åˆ¤æ–­çš„ã€‚ä½†æ˜¯åœ¨æ–°çš„é¡¹ç›®ä¸­ä¸¥æ ¼è§„èŒƒä½¿ç”¨å¼‚å¸¸æŠ›å‡º, ä½†æ˜¯å¼‚å¸¸æŠ›å‡ºå http code è¿”å›çš„æ˜¯ <code>500</code>ã€‚å¯¼è‡´æµ‹è¯•é€šè¿‡ä¸äº†, æ²¡æœ‰åŠæ³•åªèƒ½ä¿®æ”¹ã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>ä½¿ç”¨äº†å¼‚å¸¸æŠ›å‡ºä¸šåŠ¡é”™è¯¯, åœ¨ <code>laravel</code> æ¡†æ¶ä¸­, å¼‚å¸¸éƒ½æ˜¯ç»Ÿä¸€å¤„ç†çš„, åœ¨ <code>App\Exceptions\Handle</code> é‡Œé¢è¿›è¡Œäº†å…¨å±€å¤„ç†ã€‚å¯¹äºæ¡†æ¶æŠ›å‡ºçš„å¼‚å¸¸, å…¨éƒ¨ç”±å®ƒæ¥å¤„ç†ã€‚ä½†æ˜¯å½“ä½ æƒ³è¦åœ¨ <code>Handle</code> é‡Œé¢ä¿®æ”¹å¤„ç†çš„æ—¶å€™, ä½ ä¼šå‘ç°å¹¶ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚åˆ°åº•ä»€ä¹ˆåŸå› å¯¼è‡´çš„å‘¢ï¼Ÿ</p><p>åœ¨å…¥å£æ–‡ä»¶å¯ä»¥çœ‹åˆ°è¿™ä¹ˆä¸€æ®µä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$app-&gt;singleton(</span><br><span class="line">    Illuminate\Contracts\Debug\ExceptionHandler::class,</span><br><span class="line">    App\Exceptions\Handler::class</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œè¿›è¡Œäº†å…¨å±€çš„å¼‚å¸¸æœåŠ¡æ³¨å†Œ, è¿™é‡Œå…ˆä¸å…³æ³¨å¼‚å¸¸åœ¨å“ªé‡Œå¤„ç†çš„ã€‚æ—¢ç„¶å®é™…æ˜¯æ²¡æœ‰é€šè¿‡ Hanle ç±»å¤„ç†, çŒœæµ‹è¿™é‡ŒæœåŠ¡å¯èƒ½è¢« Dingo é‡æ–°æ³¨å†Œè¿‡äº†ã€‚å¸¦ç€è¿™ä¸ªæƒ³æ³•å¯ä»¥çœ‹ä¸€ä¸‹ Dingo çš„æœåŠ¡æ³¨å†Œã€‚åœ¨ <code>Dingo\Api\Provider\DingoServiceProvider</code> çœ‹åˆ°äº†å¼‚å¸¸æ³¨å†Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">registerExceptionHandler</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;app-&gt;singleton(<span class="string">'api.exception'</span>, <span class="function"><span class="keyword">function</span> <span class="params">($app)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ExceptionHandler($app[<span class="string">'Illuminate\Contracts\Debug\ExceptionHandler'</span>], <span class="keyword">$this</span>-&gt;config(<span class="string">'errorFormat'</span>), <span class="keyword">$this</span>-&gt;config(<span class="string">'debug'</span>));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè‚¯å®šä¼šæœ‰ç–‘é—®äº†, è¿™ä¸ªå•ä¾‹æ¨¡å¼ä¹Ÿæ²¡æœ‰é‡æ–°æ³¨å†Œ <code>Illuminate\Contracts\Debug\ExceptionHandler::class</code> è¿™ä¸ªç±»å•Šï¼Ÿæ²¡é”™, å› ä¸º Dingo æ¥ç®¡äº†è·¯ç”±, ä½ å®é™…ä½¿ç”¨çš„ <code>\Dingo\Api\Routing\Router::class</code>, æ‰€ä»¥ Dispatch çš„ä¼šç”± Dingo æ¥æ‰§è¡Œã€‚è¿™é‡Œå°±ä¸ç»†è¯´äº†ã€‚æœ‰å…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹ Dingo çš„å¤„ç†ã€‚<br>Dispatch å¤„ç†å¯ä»¥åœ¨ <code>Dingo\Api\Dispatcher</code>é‡Œé¢æ‰¾åˆ°ã€‚æ¥çœ‹ä¸€ä¸‹ä»£ç å¤„ç†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span><span class="params">(InternalRequest $request)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;routeStack[] = <span class="keyword">$this</span>-&gt;router-&gt;getCurrentRoute();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;clearCachedFacadeInstance();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;container-&gt;instance(<span class="string">'request'</span>, $request);</span><br><span class="line"></span><br><span class="line">            $response = <span class="keyword">$this</span>-&gt;router-&gt;dispatch($request);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (! $response-&gt;isSuccessful() &amp;&amp; ! $response-&gt;isRedirection()) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> InternalHttpException($response);</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (! <span class="keyword">$this</span>-&gt;raw) &#123;</span><br><span class="line">                $response = $response-&gt;getOriginalContent();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä¸»è¦çœ‹è¿™é‡Œçš„ exception å¤„ç† è¿™é‡Œå°±æ˜¯æ¥ç®¡çš„å¼‚å¸¸</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (HttpExceptionInterface $exception) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;refreshRequestStack();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">throw</span> $exception;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;refreshRequestStack();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $response;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å…ˆä¸ç”¨ç®¡è¿™ä¸ªæ¥å£ç±»çš„å¼‚å¸¸, æ¥çœ‹çœ‹ Dingo çš„ Handle å¦‚ä½•å¤„ç†çš„ã€‚ä¸‹é¢ä¼šæåˆ°å¤„ç†ä¸ºä½•è¿™é‡Œæ˜¯æ¥å£, è¿˜æœ‰è¯¥å¦‚ä½•ä¿®æ”¹ã€‚</p><p>ä½ éœ€è¦ä» render æ–¹æ³•æ¥æ˜¯æŸ¥æ‰¾, ä½ æœ€ç»ˆä¼šçœ‹åˆ°, è¿‡ç¨‹å°±ä¸ç»†è®²äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getExceptionStatusCode</span><span class="params">(Exception $exception, $defaultStatusCode = <span class="number">500</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ($exception <span class="keyword">instanceof</span> HttpExceptionInterface) ? $exception-&gt;getStatusCode() : $defaultStatusCode;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±å’Œä¸Šé¢çš„æ¥å£ç±»å¯¹åº”äº†, ä¸ºä»€ä¹ˆè¿”å› 500 å‘¢ï¼Ÿçœ‹è¿™æ®µä»£ç å·²ç»ä¸€ç›®äº†ç„¶äº†ã€‚å¦‚æœä¸æ˜¯å®ç°äº† <code>HttpExceptionInterface</code> çš„å¼‚å¸¸ç±», <code>StatusCode</code> éƒ½æ˜¯è¿”å› 500ã€‚æ‰€ä»¥éœ€è¦åšçš„å°±å¾ˆç®€å•äº†, å®ç° <code>HttpExceptionInterface</code> å°±å¯ä»¥äº†ã€‚ç®€å•å®ç°:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseException</span> <span class="keyword">extends</span> \<span class="title">Exception</span>  <span class="keyword">implements</span> <span class="title">HttpExceptionInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getStatusCode</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">200</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns response headers.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array Response headers</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getHeaders</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ª exception åŸºç±», éœ€è¦çš„å°±æ˜¯ç»§æ‰¿å°±å¯ä»¥äº†ã€‚è¿™æ ·å°±å¯ä»¥è§£å†³è¯¥é—®é¢˜äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h2&gt;&lt;p&gt;å…¬å¸éœ€è¦å°†è€é¡¹ç›®è¿ç§», ç”±äºä¹‹å‰çš„é”™è¯¯è¿”å›éƒ½æ˜¯ä¸è§„èŒƒçš„, å¯¹äºé”™è¯¯å¤„ç†éƒ½æ˜¯ç›´æ¥è¿”å› &lt;strong&gt;200&lt;/strong&gt; http co
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="laravel" scheme="https://njphper.com/tags/laravel/"/>
    
  </entry>
  
  <entry>
    <title>cURL æŠ¥é”™ error 60 SSL certificate problem unable to get local issuer certificate</title>
    <link href="https://njphper.com/posts/curl-error-60/"/>
    <id>https://njphper.com/posts/curl-error-60/</id>
    <published>2019-05-03T18:07:45.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨ Laravel æ¡†æ¶çš„æ—¶å€™, å¼€å‘ç¬¬ä¸‰æ–¹æœåŠ¡çš„æ—¶å€™, ç”±äºæ˜¯æœ¬åœ°å¼€å‘, æ‰€ä»¥ Https å›è°ƒçš„æ—¶å€™å›å‡ºç°è¿™æ ·çš„é”™è¯¯ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ å…·ä½“ä¿¡æ¯å¦‚ä¸‹</p><blockquote><p>cURL error 60: SSL certificate problem: unable to get local issuer certificate (see http: curl.haxx.se libcurl c libcurl errors.html)</p></blockquote><h2 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§é”™è¯¯ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§é”™è¯¯ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§é”™è¯¯ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§é”™è¯¯ï¼Ÿ</h2><p>ç”±äºæ•æ„Ÿä¿¡æ¯çš„ä¼ è¾“é€šå¸¸åœ¨æ•°å­—è¯ä¹¦ä¸‹è¿›è¡Œã€‚ è¯¥è¯ä¹¦å°†æœ‰åŠ©äºå‘æ”¶ä»¶äººç¡®è®¤å‘ä»¶äººå®é™…ä¸Šæ˜¯ä»–ä»¬å£°ç§°çš„äººã€‚ æ•°å­—è¯ä¹¦ç”±è¯ä¹¦æœºæ„é¢å‘ã€‚</p><p>å½“æ•°å­—è¯ä¹¦åº”ç”¨äºæœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¸Šä¼šå®‰è£…å¯ä¿¡è¯ä¹¦é¢å‘æœºæ„åŠå…¶æ ¹è¯ä¹¦çš„åˆ—è¡¨ã€‚ é€šè¿‡å¸¸è§„ HTTPS è¿›è¡Œçš„äº‹åŠ¡å°†æ¢å¤åˆ°æ­¤åˆ—è¡¨ä»¥è¿›è¡Œé€šä¿¡ã€‚ ä½†æ˜¯ï¼ŒCURL ä¸éµå®ˆè§„åˆ™ã€‚ æ‚¨éœ€è¦å‘Šè¯‰ <code>Curl</code> æœ‰å…³ <code>Ca</code> æ ¹è¯ä¹¦çš„ä¿¡æ¯ã€‚</p><h2 id="å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="å¦‚ä½•è§£å†³ï¼Ÿ"></a>å¦‚ä½•è§£å†³ï¼Ÿ</h2><p>è¦è§£å†³è¯¥é”™è¯¯ï¼Œæ‚¨éœ€è¦å®šä¹‰ <code>CURL</code> è¯ä¹¦é¢å‘æœºæ„ä¿¡æ¯è·¯å¾„<br>è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œåœ¨æ­¤å¤„ä¸‹è½½æœ€æ–°çš„ <code>curl</code> <a href="httpsï¼š//curl.haxx.se/ca/cacert.pem"><strong>è®¤å¯è¯ä¹¦</strong></a>,<br>å°† <code>cacert.pem</code> æ–‡ä»¶ä¿å­˜åœ¨å¯åˆ°è¾¾çš„ç›®æ ‡ä¸­ã€‚<br>ç„¶åï¼Œåœ¨ <code>php.ini</code> æ–‡ä»¶ä¸­ï¼Œå‘ä¸‹æ»šåŠ¨åˆ°æ‰¾åˆ° [curl] çš„ä½ç½®ã€‚<br>æ‚¨åº”è¯¥çœ‹åˆ°æ³¨é‡Šæ‰äº† <code>CURLOPT_CAINFO</code> é€‰é¡¹ã€‚ å–æ¶ˆæ³¨é‡Šå¹¶å°†å…¶æŒ‡å‘ <code>cacert.pem</code> æ–‡ä»¶ã€‚ ä½ åº”è¯¥æœ‰è¿™æ ·çš„ä¸€è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl.cainfo =â€œè¯ä¹¦è·¯å¾„\cacert.pemâ€</span><br></pre></td></tr></table></figure><p>ä¿å­˜å¹¶å…³é—­ <code>php.ini</code>ã€‚ é‡æ–°å¯åŠ¨æ‚¨çš„ç½‘ç»œæœåŠ¡å™¨å¹¶å†æ¬¡å°è¯•æ‚¨çš„è¯·æ±‚</p><p>å¦‚æœæœªè®¾ç½®æ­£ç¡®çš„ä½ç½®ï¼Œåˆ™ä¼šå‡ºç° <code>CURL 77</code> é”™è¯¯ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨ä½¿ç”¨ Laravel æ¡†æ¶çš„æ—¶å€™, å¼€å‘ç¬¬ä¸‰æ–¹æœåŠ¡çš„æ—¶å€™, ç”±äºæ˜¯æœ¬åœ°å¼€å‘, æ‰€ä»¥ Https å›è°ƒçš„æ—¶å€™å›å‡ºç°è¿™æ ·çš„é”™è¯¯ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ å…·ä½“ä¿¡æ¯å¦‚ä¸‹&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;cURL error 60: SSL certificate proble
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="curl" scheme="https://njphper.com/tags/curl/"/>
    
  </entry>
  
  <entry>
    <title>mac å®‰è£… man ä¸­æ–‡æ‰‹å†Œ</title>
    <link href="https://njphper.com/posts/mac-install-man/"/>
    <id>https://njphper.com/posts/mac-install-man/</id>
    <published>2019-04-28T06:25:41.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å®‰è£…-man-ä¸­æ–‡æ‰‹å†Œ"><a href="#å®‰è£…-man-ä¸­æ–‡æ‰‹å†Œ" class="headerlink" title="å®‰è£… man ä¸­æ–‡æ‰‹å†Œ"></a>å®‰è£… man ä¸­æ–‡æ‰‹å†Œ</h2><p>åœ¨ä½¿ç”¨ mac æˆ–è€… linux çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ°å‘½ä»¤ï¼Œè€Œå¤§é‡çš„å‘½ä»¤å«æœ‰å¤§é‡ optionsï¼Œä¸€èˆ¬å¾ˆéš¾è®°ä½ï¼Œä½¿ç”¨ <code>man</code> å¯ä»¥æŸ¥çœ‹è¿™äº›å‘½ä»¤çš„ optionsï¼Œä½†å¯¹äºè‹±è¯­è–„å¼±çš„äººæ¥è¯´ï¼Œä¾‹å¦‚æˆ‘ï¼Œçœ‹èµ·æ¥è¿˜æ˜¯æœ‰ä¸€å®šçš„å›°éš¾ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…ä»¥ä¸‹ä¸­æ–‡æ‰‹å†Œã€‚<br>å‡†å¤‡å‰ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸¤ä¸ª packageï¼Œå‰æä½ æ˜¯ä½¿ç”¨äº† brew ç®¡ç†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install automake</span><br><span class="line">&gt; brew install opencc</span><br></pre></td></tr></table></figure><p>ç„¶åéœ€è¦ä¸‹è½½ä¸­æ–‡åŒ…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; git clone  https:&#x2F;&#x2F;github.com&#x2F;man-pages-zh&#x2F;manpages-zh</span><br><span class="line">&gt; cd manpages-zh</span><br><span class="line">&gt; autoreconf --install --force</span><br><span class="line">&gt;  .&#x2F;configure</span><br><span class="line">&gt; sudo make</span><br><span class="line">&gt; sudo make install</span><br></pre></td></tr></table></figure><p>ç­‰å¾…ç¼–è¯‘å®Œæˆä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦é…ç½®ä¸€äº›ä¸œè¥¿ã€‚å¦‚æœä½ ä¹‹å‰æ²¡æœ‰æ›´æ–° groffï¼Œéœ€è¦å…ˆæ›´æ–° groffï¼Œä¸ç„¶ä¼šå‡ºç°ä¹±ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install groff </span><br><span class="line">&gt; echo &quot;MANPATH &#x2F;usr&#x2F;local&#x2F;share&#x2F;man&#x2F;zh_CN&quot; &gt;&gt; &#x2F;etc&#x2F;man.conf</span><br><span class="line">&gt; echo &quot;NROFF preconv -e UTF8 | &#x2F;usr&#x2F;local&#x2F;bin&#x2F;nroff -Tutf8 -mandoc -c&quot; &gt;&gt; &#x2F;etc&#x2F;man.conf</span><br><span class="line">&gt; export alias cman&#x3D;&#39;man -M &#x2F;usr&#x2F;local&#x2F;share&#x2F;man&#x2F;zh_CN&#39; &#x2F;&#x2F; ä½ å¯ä»¥åŠ å…¥åˆ°ç¯å¢ƒå˜é‡é‡Œ</span><br><span class="line">&gt; cman ls</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ man ä¸­æ–‡æ‰‹å†Œå•¦</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å®‰è£…-man-ä¸­æ–‡æ‰‹å†Œ&quot;&gt;&lt;a href=&quot;#å®‰è£…-man-ä¸­æ–‡æ‰‹å†Œ&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£… man ä¸­æ–‡æ‰‹å†Œ&quot;&gt;&lt;/a&gt;å®‰è£… man ä¸­æ–‡æ‰‹å†Œ&lt;/h2&gt;&lt;p&gt;åœ¨ä½¿ç”¨ mac æˆ–è€… linux çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ°å‘½ä»¤ï¼Œè€Œå¤§é‡çš„å‘½ä»¤
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="macos" scheme="https://njphper.com/tags/macos/"/>
    
  </entry>
  
  <entry>
    <title>è¯¦è§£ Linux æ–‡ä»¶æƒé™</title>
    <link href="https://njphper.com/posts/linux-file-mode/"/>
    <id>https://njphper.com/posts/linux-file-mode/</id>
    <published>2019-04-23T07:36:59.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux-æ–‡ä»¶æƒé™"><a href="#Linux-æ–‡ä»¶æƒé™" class="headerlink" title="Linux æ–‡ä»¶æƒé™"></a>Linux æ–‡ä»¶æƒé™</h2><p>åœ¨æ·±å…¥äº†è§£ä¹‹å‰ï¼Œå…ˆæ¥ç†è§£ä¸€ä¸‹æ–‡ä»¶æƒé™çš„åŸºæœ¬ä¿¡æ¯ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªä¿¡æ¯çš„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; touch new_file</span><br><span class="line">&gt; ll new_file</span><br><span class="line">&gt; -rw-r--r-- 1 root root 0 4æœˆ  23 22:59 new_file</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ new_file æ‹¥æœ‰ä¸‹é¢ä¸‰ç»„æƒé™:</p><blockquote><p>rw- :æ–‡ä»¶çš„å±ä¸»ï¼Œç™»é™†ç”¨æˆ·çš„æƒé™ r w åˆ†åˆ«æ˜¯è¯»å†™</p><p>râ€“ : æ–‡ä»¶å±ä¸»çš„æ‰€å±ç»„çš„æƒé™ r è¯»</p><p>râ€“: å…¶ä»–ç”¨æˆ·çš„æƒé™ r è¯»</p></blockquote><p>å½“ç„¶è¿˜æœ‰ä¸€ä¸ª <code>x</code> å¯æ‰§è¡Œæƒé™è¿™é‡Œæ²¡æœ‰ï¼Œå¯ä»¥é€šè¿‡ <code>chmod</code> å‘½ä»¤æ¥å¢åŠ ã€‚è¿™ä¸ªåé¢å†è¯´ã€‚æˆ‘ä»¬å…ˆæ¥è¯´è¯´æ–‡ä»¶æƒé™çš„ç”±æ¥ï¼Œ<code>touch</code> å‘½ä»¤ä¹‹åçš„é»˜è®¤æƒé™æ˜¯å¦‚ä½•æ¥çš„ã€‚è¦çŸ¥é“é¦–å…ˆè¦çŸ¥é“æœ‰ <code>umask</code> çš„å­˜åœ¨ã€‚é€šè¿‡ <code>umask</code> å‘½ä»¤å¯ä»¥è·å–é»˜è®¤å€¼ã€‚è¿™ä¸ªå€¼å¾ˆæœ‰ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; umask</span><br><span class="line">&gt; 0022 &#x2F;&#x2F; è¿™æ˜¯æˆ‘æœºå™¨ä¸Šé¢çš„å€¼</span><br></pre></td></tr></table></figure><p>è¦äº†è§£è¿™ä¸ª umask çš„æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé¦–å…ˆè¦ç†è§£ä¸€ä¸‹å…«è¿›åˆ¶æ¨¡å¼çš„å®‰å…¨æ€§è®¾ç½®ã€‚å…«è¿›åˆ¶æ¨¡å¼çš„å®‰å…¨è®¾ç½®å…ˆè·å–è¿™ä¸‰ä¸ª rwx æƒé™çš„å€¼ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä¸‰ä½äºŒè¿›åˆ¶å€¼ï¼Œç”¨ä¸€ä¸ªå…«è¿›åˆ¶å€¼æ¥è¡¨ç¤ºã€‚åœ¨è¿™ä¸ªäºŒè¿›åˆ¶è¡¨ç¤ºä¸­ï¼Œæ¯ä¸ªä½ç½®ä»£è¡¨ä¸€ä¸ªäºŒè¿›åˆ¶ä½ã€‚ä¾‹å¦‚å”¯ä¸€è¯»æƒé™ râ€“ è½¬æ¢æˆäºŒè¿›åˆ¶å°±æ˜¯ 100, é‚£ä¹ˆä»£è¡¨çš„å…«è¿›åˆ¶å°±æ˜¯ 4ã€‚<br>å¦‚ä¸‹è¡¨è¡¨ç¤ºçš„è¿™æ ·ï¼š</p><table><thead><tr><th>æƒé™</th><th>äºŒè¿›åˆ¶</th><th>å…«è¿›åˆ¶</th><th>æè¿°</th></tr></thead><tbody><tr><td>â€”</td><td>000</td><td>0</td><td>æ²¡æœ‰ä»»ä½•æƒé™</td></tr><tr><td>â€“x</td><td>0001</td><td>1</td><td>åªæœ‰å¯æ‰§è¡Œæƒé™</td></tr><tr><td>-w-</td><td>010</td><td>2</td><td>åªæœ‰å¯å†™æƒé™</td></tr><tr><td>-wx</td><td>011</td><td>3</td><td>åªæœ‰å¯å†™å¯æ‰§è¡Œæƒé™</td></tr><tr><td>râ€“</td><td>100</td><td>4</td><td>åªæœ‰å¯è¯»æƒé™</td></tr><tr><td>r-x</td><td>101</td><td>5</td><td>åªæœ‰å¯è¯»å¯æ‰§è¡Œæƒé™</td></tr><tr><td>rw-</td><td>110</td><td>6</td><td>åªæœ‰å¯è¯»å¯å†™æƒé™</td></tr><tr><td>rwx</td><td>111</td><td>7</td><td>å¯è¯»å¯å†™æƒé™å¯æ‰§è¡Œ</td></tr></tbody></table><p>å½“äº†è§£å¯¹åº”æƒé™ä»¥åŠå…«è¿›åˆ¶å€¼ä¹‹åï¼Œçœ‹çœ‹ä¸Šé¢çš„ new_file æ‹¥æœ‰æƒé™æ˜¯ 644ã€‚é‚£ä¹ˆè¿™é‡Œæœ‰ç‚¹å›°æƒ‘äº†ï¼Œè¿™ä¸ªå€¼æ˜¯å¦‚ä½•å¾—æ¥çš„å‘¢ã€‚ <code>umask</code> çš„ <code>0022</code> æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå…¶å®è¿™ä¸ªå€¼åªæ˜¯ä¸ªæ©ç ã€‚ä»–ä¼šå±è”½æ‰ä¸åƒæˆäºˆè¯¥å®‰å…¨çº§åˆ«çš„æƒé™ã€‚å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œå…¨æƒé™æ˜¯ <code>666</code>ï¼Œå‡å» <code>umask</code> çš„å€¼å°±æ˜¯æ–°åˆ›å»ºæ–‡ä»¶çš„æƒé™ã€‚ 644 æ­£æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„é‚£æ ·ï¼Œé»˜è®¤å±è”½äº†æ–‡ä»¶æ‰€å±ç»„å’Œå…¶ä»–ç”¨æˆ· w æƒé™ã€‚è¿™é‡Œè¯´æ˜ä¸€ä¸‹æ–‡ä»¶å¤¹çš„å…¨æƒé™æ˜¯ 777ã€‚å¦‚æœä½ æƒ³å±è”½æ›´å¤šçš„æƒé™ï¼Œå¯ä»¥ä¿®æ”¹ umask çš„å€¼ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; umask 026</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Linux-æ–‡ä»¶æƒé™&quot;&gt;&lt;a href=&quot;#Linux-æ–‡ä»¶æƒé™&quot; class=&quot;headerlink&quot; title=&quot;Linux æ–‡ä»¶æƒé™&quot;&gt;&lt;/a&gt;Linux æ–‡ä»¶æƒé™&lt;/h2&gt;&lt;p&gt;åœ¨æ·±å…¥äº†è§£ä¹‹å‰ï¼Œå…ˆæ¥ç†è§£ä¸€ä¸‹æ–‡ä»¶æƒé™çš„åŸºæœ¬ä¿¡æ¯ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªä¿¡æ¯çš„æ–‡ä»¶&lt;/p
      
    
    </summary>
    
    
      <category term="æœåŠ¡å™¨è¿ç»´" scheme="https://njphper.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="linux" scheme="https://njphper.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Mac SSH è¿æ¥å‡ºç° Host key verification failed é”™è¯¯è§£å†³</title>
    <link href="https://njphper.com/posts/mac-vertify-failed/"/>
    <id>https://njphper.com/posts/mac-vertify-failed/</id>
    <published>2019-04-18T21:07:56.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬ä½¿ç”¨ <a href="javascript:;"><strong>ssh</strong></a> é“¾æ¥ <a href="javascript:;"><strong>linux</strong></a> ä¸»æœºæ—¶ï¼Œå¯èƒ½å‡ºç° â€œ<a href="javascript:;"><strong>Host</strong></a> <a href="javascript:;"><strong>key</strong></a> verification failed.â€œ çš„æç¤ºï¼Œssh è¿æ¥ä¸æˆåŠŸã€‚<br>å¯èƒ½çš„æç¤ºä¿¡æ¯å¦‚ä¸‹:</p><blockquote><p>IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br>Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br>It is also possible that the RSA host key has just been changed.<br>The fingerprint for the RSA key sent by the remote host is<br>23:00:20:83:de:02:95:f1:e3:34:be:57:3f:cf:2c:e7.<br>Please contact your system administrator.<br>Add correct host key in /home/xahria/.ssh/known_hosts to get rid of this message.<br>Offending key in /home/xahria/.ssh/known_hosts:8<br>RSA host key for localhost has changed and you have requested strict checking.<br>Host key verification failed.</p></blockquote><p>ç½‘ä¸Šå¾ˆå¤šçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š<code>vi ~/.ssh/known_hosts</code> åˆ é™¤ä¸æƒ³è¦è¿æ¥çš„ä¸»æœºç›¸å…³çš„è¡Œï¼›æˆ–è€…ç›´æ¥åˆ é™¤<code>known_hosts</code> è¿™ä¸ªæ–‡ä»¶ã€‚ å½“ç„¶è¿™ä¸ªæ–¹æ¡ˆä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½†å¹¶éè§£å†³é—®é¢˜çš„æ ¹æœ¬åŠæ³•ï¼Œå› ä¸ºç»§ç»­ä½¿ç”¨ï¼Œä»Šåè¿˜ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œè¿˜å¾—å†åˆ é™¤ã€‚<br>ä¸‹é¢ç®€å•è®²ä¸€ä¸‹è¿™ä¸ªé—®é¢˜çš„åŸç†å’Œæ¯”è¾ƒé•¿ä¹…çš„è§£å†³æ–¹æ¡ˆã€‚<br>ç”¨<code>OpenSSH</code>çš„äººéƒ½çŸ¥sshä¼šæŠŠä½ æ¯ä¸ªä½ è®¿é—®è¿‡è®¡ç®—æœºçš„å…¬é’¥(public key)éƒ½è®°å½•åœ¨ <code>~/.ssh/known_hosts</code>ã€‚å½“ä¸‹æ¬¡è®¿é—®ç›¸åŒè®¡ç®—æœºæ—¶ï¼Œ<code>OpenSSH</code> ä¼šæ ¸å¯¹å…¬é’¥ã€‚å¦‚æœå…¬é’¥ä¸åŒï¼Œ<code>OpenSSH</code>ä¼šå‘å‡ºè­¦å‘Šï¼Œé¿å…ä½ å—åˆ°DNS Hijackä¹‹ç±»çš„æ”»å‡»ã€‚<br>SSH å¯¹ä¸»æœºçš„ public_key çš„æ£€æŸ¥ç­‰çº§æ˜¯æ ¹æ® <code>StrictHostKeyChecking</code> å˜é‡æ¥é…ç½®çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>StrictHostKeyChecking=ask</code>ã€‚ç®€å•æ‰€ä¸‹å®ƒçš„ä¸‰ç§é…ç½®å€¼ï¼š</p><p>1.<code>StrictHostKeyChecking=no</code>æœ€ä¸å®‰å…¨çš„çº§åˆ«ï¼Œå½“ç„¶ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¤šçƒ¦äººçš„æç¤ºäº†ï¼Œç›¸å¯¹å®‰å…¨çš„å†…ç½‘<a href="javascript:;"><strong>æµ‹è¯•</strong></a>æ—¶å»ºè®®ä½¿ç”¨ã€‚å¦‚æœè¿æ¥<a href="javascript:;"><strong>server</strong></a>çš„ key åœ¨æœ¬åœ°ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨æ·»åŠ åˆ°æ–‡ä»¶ä¸­ï¼ˆé»˜è®¤æ˜¯known_hostsï¼‰ï¼Œå¹¶ä¸”ç»™å‡ºä¸€ä¸ªè­¦å‘Šã€‚</p><p>2.<code>StrictHostKeyChecking=ask</code>  é»˜è®¤çš„çº§åˆ«ï¼Œå°±æ˜¯å‡ºç°åˆšæ‰çš„æç¤ºäº†ã€‚å¦‚æœè¿æ¥å’Œkeyä¸åŒ¹é…ï¼Œç»™å‡ºæç¤ºï¼Œå¹¶æ‹’ç»ç™»å½•ã€‚</p><p>3.<code>StrictHostKeyChecking=yes</code>  æœ€å®‰å…¨çš„çº§åˆ«ï¼Œå¦‚æœè¿æ¥ä¸keyä¸åŒ¹é…ï¼Œå°±æ‹’ç»è¿æ¥ï¼Œä¸ä¼šæç¤ºè¯¦ç»†ä¿¡æ¯ã€‚</p><p>å¯¹äºæˆ‘æ¥è¯´ï¼Œåœ¨å†…ç½‘çš„è¿›è¡Œçš„ä¸€äº›æµ‹è¯•ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œé€‰æ‹©æœ€ä½çš„å®‰å…¨çº§åˆ«ã€‚åœ¨ .ssh/configï¼ˆæˆ–è€… /etc/ssh/ssh_config ï¼‰ä¸­é…ç½®ï¼š<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> StrictHostKeyChecking no</span><br><span class="line">UserKnownHostsFile &#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure></p><blockquote><p>ï¼ˆæ³¨ï¼šè¿™é‡Œä¸ºäº†ç®€ä¾¿ï¼Œå°† knownhostfile è®¾ä¸º /dev/nullï¼Œå°±ä¸ä¿å­˜åœ¨ known_hosts ä¸­äº†ï¼‰</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ &lt;a href=&quot;javascript:;&quot;&gt;&lt;strong&gt;ssh&lt;/strong&gt;&lt;/a&gt; é“¾æ¥ &lt;a href=&quot;javascript:;&quot;&gt;&lt;strong&gt;linux&lt;/strong&gt;&lt;/a&gt; ä¸»æœºæ—¶ï¼Œå¯èƒ½å‡ºç° â€œ&lt;a href=&quot;javascript:;
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="macos" scheme="https://njphper.com/tags/macos/"/>
    
  </entry>
  
  <entry>
    <title>Go å¦‚ä½•å®ç°å…¼å®¹ PHP çš„å¯†ç åŠ å¯†è§£å¯†</title>
    <link href="https://njphper.com/posts/go-to-php-passwordhash/"/>
    <id>https://njphper.com/posts/go-to-php-passwordhash/</id>
    <published>2019-04-16T21:28:53.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ­£åœ¨è¿ç§»è‡ªå·±çš„å°é¡¹ç›®ï¼Œé¡¹ç›®ä¹‹å‰æ˜¯åŸºäº <strong>Laravel5.5</strong> å¼€å‘çš„ã€‚æ•´ä¸ªç”¨æˆ·ç™»é™†ä¹Ÿæ˜¯åŸºäºæ¡†æ¶çš„ Auth åŒ…è®¤è¯çš„ã€‚å…¶ä¸­ç”¨æˆ·å¯†ç è¿™å—ä¹Ÿæ˜¯ç”¨åˆ°äº† <code>PHP</code> å†…ç½®çš„å‡½æ•° <code>password_hash</code>ï¼Œç”¨å®ƒè¿›è¡Œå¯†ç åŠ å¯†ã€‚è€Œä¸” PHP é»˜è®¤ä½¿ç”¨çš„ PASSWORD_BCRYPT ç®—æ³•ã€‚åœ¨ä½¿ç”¨ Go çš„è¿ç§»è¿‡ç¨‹ä¸­éœ€è¦è®¤è¯å¯†ç ï¼Œè¿˜éœ€è¦å…¼å®¹ <code>password_hash</code>, æ‰€ä»¥å°±æŠŠè¿™ä¸ªè¿‡ç¨‹è®°å½•ä¸‹æ¥ã€‚ä½¿ç”¨ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ GO <a href="https://godoc.org/golang.org/x/crypto/bcrypt" target="_blank" rel="noopener">bcrypt</a> åŒ…æ¥å¯¹ä½ çš„å¯†ç è¿›è¡Œ hash å’Œ salt åŠ å¯†</p><p>å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ªæ§åˆ¶å°åº”ç”¨ç¨‹åºï¼Œç”¨äºæ¼”ç¤ºå¦‚ä½•è·å–ç”¨æˆ·è¾“å…¥çš„å¯†ç å¹¶ä½¿ç”¨å®ƒç”Ÿæˆ salt å“ˆå¸Œå€¼ã€‚ å®Œæˆæ­¤æ“ä½œåï¼Œæˆ‘å°†é€šè¿‡æ¯”è¾ƒå¯†ç ä¸å…¶æ•£åˆ—ç‰ˆæœ¬æ¥éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®ã€‚</p><h3 id="è·å–ç”¨æˆ·è¾“å…¥çš„å¯†ç "><a href="#è·å–ç”¨æˆ·è¾“å…¥çš„å¯†ç " class="headerlink" title="è·å–ç”¨æˆ·è¾“å…¥çš„å¯†ç "></a>è·å–ç”¨æˆ·è¾“å…¥çš„å¯†ç </h3><p>å¼€å§‹æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå¯ä»¥åœ¨æ§åˆ¶å°è¯»å–ç”¨æˆ·è¾“å…¥çš„çš„æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">func getPwd() []byte &#123;</span><br><span class="line">    fmt.Println(&quot;Enter a password&quot;)</span><br><span class="line">    var pwd string</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; è¯»å–ç”¨æˆ·è¾“å…¥</span><br><span class="line">    _, err :&#x3D; fmt.Scan(&amp;pwd)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    return []byte(pwd)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#96;</span><br></pre></td></tr></table></figure><h3 id="Hash-amp-Salt-ç”¨æˆ·çš„å¯†ç "><a href="#Hash-amp-Salt-ç”¨æˆ·çš„å¯†ç " class="headerlink" title="Hash &amp; Salt ç”¨æˆ·çš„å¯†ç "></a>Hash &amp; Salt ç”¨æˆ·çš„å¯†ç </h3><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Go çš„ <a href="https://godoc.org/golang.org/x/crypto/bcrypt" target="_blank" rel="noopener">bcrypt</a> åŒ…æä¾›çš„<code>GenerateFromPassword(password []byte, cost int)([]byte, error)</code>æ–¹æ³•å¯¹ç”¨æˆ·çš„å¯†ç è¿›è¡Œ hash å’Œ salt åŠ å¯†äº†ã€‚</p><blockquote><p>GenerateFromPassword æ–¹æ³•ä»¥ç»™å®š cost å€¼è¿”å›å¯†ç çš„ Bcrypt ç®—æ³•çš„ Hash å€¼ï¼Œå¦‚æœæä¾›çš„ cost å€¼å°äº Mincost çš„è¯ï¼Œå°†ä¼šé»˜è®¤ä½¿ç”¨ DefaultCost ä»£æ›¿</p></blockquote><p>ä½¿ç”¨ <code>GenerateFromPassword</code> å‡½æ•°çš„ä¸€ä¸ªä¼˜åŠ¿å°±æ˜¯æˆ‘ä»¬ä¸éœ€è¦è‡ªå·±æ¥ç¼–å†™å‡½æ•°æ¥ç”Ÿæˆ Saltï¼Œå› ä¸ºå®ƒä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª Saltã€‚</p><p>ä¸‹é¢çš„å‡½æ•°ä½¿ç”¨ <code>GenerateFromPassword</code> ç”Ÿæˆ salted å“ˆå¸Œå€¼ï¼Œè¯¥å“ˆå¸Œå€¼ä½œä¸ºå­—èŠ‚åˆ‡ç‰‡è¿”å›ã€‚ ç„¶åæˆ‘ä»¬å°†å­—èŠ‚åˆ‡ç‰‡ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å°† salted å“ˆå¸Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ä½œä¸ºç”¨æˆ·å¯†ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">func hashAndSalt(pwd []byte) string &#123;</span><br><span class="line">    hash, err :&#x3D; bcrypt.GenerateFromPassword(pwd, bcrypt.MinCost)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    return string(hash)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç›®å‰æˆ‘ä»¬åšäº†ä»€ä¹ˆ"><a href="#ç›®å‰æˆ‘ä»¬åšäº†ä»€ä¹ˆ" class="headerlink" title="ç›®å‰æˆ‘ä»¬åšäº†ä»€ä¹ˆ"></a>ç›®å‰æˆ‘ä»¬åšäº†ä»€ä¹ˆ</h3><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ¥å—æ¥è‡ªæ§åˆ¶å°çš„ç”¨æˆ·è¾“å…¥å¹¶å°†å…¶ä½œä¸ºå­—èŠ‚åˆ‡ç‰‡è¿”å›çš„å‡½æ•°ã€‚ ç„¶å,<br>æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªå¯ä»¥æ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶è¿”å›  salted å“ˆå¸Œå€¼çš„å‡½æ•°ã€‚ä¸‹é¢å°±æ˜¯ä»£ç äº‹ä¾‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">    &quot;log&quot;</span><br><span class="line">&quot;golang.org&#x2F;x&#x2F;crypto&#x2F;bcrypt&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">   for &#123;</span><br><span class="line">        pwd :&#x3D; getPwd()</span><br><span class="line">        hash :&#x3D; hashAndSalt(pwd)</span><br><span class="line">        fmt.Println(&quot;Salted Hash&quot;, pwd)</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œå°†ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; $ Enter a password</span><br><span class="line">&gt; $ foobar</span><br><span class="line">&gt; Salted Hash $2a$10$...........</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦çš„æ³¨æ„çš„æ˜¯æˆ‘ä½¿ç”¨ for å¾ªç¯è°ƒç”¨å‡½æ•°ï¼Œç›´åˆ°æˆ‘å¼ºåˆ¶åœæ­¢å®ƒã€‚å¯¹äºé‚£äº›ä¸ç†Ÿæ‚‰ GO çš„äººæ¥è®²ï¼Œè¿™ä¸ªå°±å’Œå…¶ä»–è¯­è¨€çš„ <code>while (true){}</code>æ˜¯ä¸€æ ·çš„æ•ˆæœã€‚</p><h3 id="éªŒè¯å¯†ç "><a href="#éªŒè¯å¯†ç " class="headerlink" title="éªŒè¯å¯†ç "></a>éªŒè¯å¯†ç </h3><p>æœ€åä¸€ä»¶äº‹å„¿å°±æ˜¯éœ€è¦éªŒè¯å¯†ç çš„æ­£ç¡®æ€§æ¥ç™»é™†æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://godoc.org/golang.org/x/crypto/bcrypt" target="_blank" rel="noopener">bcrypt</a> åŒ…æä¾›çš„<code>CompareHashAndPassword(hashedPassword, password []byte) error</code>å‡½æ•°</p><blockquote><p>CompareHashAndPassword å°† bcrypt å“ˆå¸Œå¯†ç ä¸å…¶çº¯æ–‡æœ¬è¿›è¡Œæ¯”è¾ƒã€‚ æˆåŠŸæ—¶è¿”å›nilï¼Œå¤±è´¥æ—¶è¿”å›é”™è¯¯</p></blockquote><p>æˆ‘ä»¬ä½¿ç”¨<code>CompareHashAndPassword</code>å‡½æ•°æ¥åˆ›å»ºå¦ä¸€ä¸ªè¿”å› bool å€¼çš„å‡½æ•°è®©æˆ‘ä»¬çŸ¥é“å¯†ç æ˜¯å¦åŒ¹é…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">func comparePasswords(hashedPwd string, plainPwd []byte) bool &#123;</span><br><span class="line"></span><br><span class="line">    byteHash :&#x3D; []byte(hashedPwd)</span><br><span class="line">    err :&#x3D; bcrypt.CompareHashAndPassword(byteHash, plainPwd)\</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">        return false</span><br><span class="line">    &#125;</span><br><span class="line">    return true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ›´æ–°-Main-å‡½æ•°"><a href="#æ›´æ–°-Main-å‡½æ•°" class="headerlink" title="æ›´æ–° Main å‡½æ•°"></a>æ›´æ–° Main å‡½æ•°</h3><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥æ›´æ–°æˆ‘ä»¬çš„ä¸»è¦åŠŸèƒ½ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿè¾“å…¥å¯†ç ï¼Œè·å–å…¶ç›æ¸å“ˆå¸Œï¼Œç„¶åå†æ¬¡è¾“å…¥å¯†ç ï¼Œå¹¶æŸ¥æ˜æˆ‘ä»¬çš„ç¬¬äºŒä¸ªå¯†ç æ˜¯å¦ä¸æˆ‘ä»¬è¾“å…¥çš„ç¬¬ä¸€ä¸ªå¯†ç ç›¸åŒ¹é…ã€‚<br>æˆ‘ä»¬ç°åœ¨ä¿®æ”¹ä¸€ä¸ª main å‡½æ•°ï¼Œå½“æˆ‘ä»¬è¾“å…¥å¯†ç çš„æ—¶å€™ï¼Œè·å– salted  å“ˆå¸Œå€¼ï¼Œç„¶åå†æ¬¡è¾“å…¥å¯†ç ï¼Œæ¥æ£€æŸ¥æˆ‘ä»¬çš„å¯†ç æ˜¯å¦åŒ¹é…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func main() &#123;</span><br><span class="line">    for &#123;</span><br><span class="line">        pwd :&#x3D; getPwd()</span><br><span class="line">        hash :&#x3D; hashAndSalt(pwd)</span><br><span class="line">        pwd2 :&#x3D; getPwd()</span><br><span class="line">        pwdMatch :&#x3D; comparePasswords(hash, pwd2)</span><br><span class="line">        fmt.Println(&quot;Passwords Match?&quot;, pwd)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¨éƒ¨ä»£ç "><a href="#å…¨éƒ¨ä»£ç " class="headerlink" title="å…¨éƒ¨ä»£ç "></a>å…¨éƒ¨ä»£ç </h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">    &quot;log&quot;</span><br><span class="line">    &quot;golang.org&#x2F;x&#x2F;crypto&#x2F;bcrypt&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    for &#123;</span><br><span class="line">       &#x2F;&#x2F; è¾“å…¥å¯†ç  è·å– hash å€¼</span><br><span class="line">        pwd :&#x3D; getPwd()</span><br><span class="line">        hash :&#x3D; hashAndSalt(pwd)</span><br><span class="line">       &#x2F;&#x2F; å†æ¬¡è¾“å…¥å¯†ç éªŒè¯</span><br><span class="line">        pwd2 :&#x3D; getPwd()</span><br><span class="line">        pwdMatch :&#x3D; comparePasswords(hash, pwd2)</span><br><span class="line">        fmt.Println(&quot;Passwords Match?&quot;, pwd)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func getPwd() []byte &#123;</span><br><span class="line">    fmt.Println(&quot;Enter a password&quot;)</span><br><span class="line">    var pwd string</span><br><span class="line">    _, err :&#x3D; fmt.Scan(&amp;pwd)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    return []byte(pwd)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func hashAndSalt(pwd []byte) string &#123;</span><br><span class="line">    hash, err :&#x3D; bcrypt.GenerateFromPassword(pwd, bcrypt.MinCost)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    return string(hash)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func comparePasswords(hashedPwd string, plainPwd []byte) bool &#123;</span><br><span class="line">    byteHash :&#x3D; []byte(hashedPwd)</span><br><span class="line"></span><br><span class="line">    err :&#x3D; bcrypt.CompareHashAndPassword(byteHash, plainPwd)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">        return false</span><br><span class="line">    &#125;</span><br><span class="line">    return true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä¾¿æ˜¯ GO è½¬ php çš„åŠ å¯†å‡½æ•°çš„è¿‡ç¨‹ï¼Œå¦‚æœæœ‰ä»»ä½•é”™è¯¯æˆ–è€…ä¸å½“çš„åœ°æ–¹æ¬¢è¿è¿›è¡Œæ”¹è¿›ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘æ­£åœ¨è¿ç§»è‡ªå·±çš„å°é¡¹ç›®ï¼Œé¡¹ç›®ä¹‹å‰æ˜¯åŸºäº &lt;strong&gt;Laravel5.5&lt;/strong&gt; å¼€å‘çš„ã€‚æ•´ä¸ªç”¨æˆ·ç™»é™†ä¹Ÿæ˜¯åŸºäºæ¡†æ¶çš„ Auth åŒ…è®¤è¯çš„ã€‚å…¶ä¸­ç”¨æˆ·å¯†ç è¿™å—ä¹Ÿæ˜¯ç”¨åˆ°äº† &lt;code&gt;PHP&lt;/code&gt; å†…ç½®çš„å‡½æ•° &lt;code&gt;password_hash&lt;/co
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://njphper.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="go" scheme="https://njphper.com/tags/go/"/>
    
  </entry>
  
  <entry>
    <title>Jwtauth è‡ªå®šä¹‰è®¤è¯å¤´ä¿¡æ¯</title>
    <link href="https://njphper.com/posts/jwtauth-header/"/>
    <id>https://njphper.com/posts/jwtauth-header/</id>
    <published>2019-04-10T21:30:35.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è‡ªå®šä¹‰è®¤è¯å¤´"><a href="#è‡ªå®šä¹‰è®¤è¯å¤´" class="headerlink" title="è‡ªå®šä¹‰è®¤è¯å¤´"></a>è‡ªå®šä¹‰è®¤è¯å¤´</h2><p>é¡¹ç›®ä½¿ç”¨çš„<code>tymon/jwt-auth</code>åŒ…ä½œä¸º <code>token</code> çš„è®¤è¯ï¼Œè¿‡ç¨‹ä¸­éœ€è¦è¿ç§»é¡¹ç›®ï¼Œå› ä¸ºä¹‹å‰å…¬å¸çš„ <code>token</code> å¤´éƒ¨ä½¿ç”¨è‡ªå®šä¹‰çš„ï¼Œå¹¶ä¸”ä»–ä»¬è¿˜ä¿®æ”¹äº†åŒ…çš„å¤´ä¿¡æ¯ã€‚å°±æ˜¯ä¸‹é¢å¤´éƒ¨ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class AuthHeaders implements ParserContract</span><br><span class="line">&#123;</span><br><span class="line">&#x2F;&#x2F; ä¸‹é¢è¿™ä¸¤å¤„å°±æ˜¯è¢«ä¿®æ”¹çš„</span><br><span class="line">    protected $header &#x3D; &#39;authorization&#39;; </span><br><span class="line"></span><br><span class="line">    protected $prefix &#x3D; &#39;bearer&#39;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿ç§»é¡¹ç›®è¿‡ç¨‹äº†ï¼Œå› ä¸ºæ‹‰å–äº†æ–°çš„åŒ…ï¼Œæ‰€ä»¥è¿˜è¦å»åŠ¨åŒ…çš„ä¿¡æ¯ï¼Œè¿™æ˜¯æå…¶ä¸åˆç†çš„è¡Œä¸ºã€‚æ‰€ä»¥å°±åœ¨åŒ…ä¸­å°è¯•æ‰¾åˆ°äº†æ›´å¥½çš„è§£å†³åŠæ³•ã€‚å¦‚æœåœ¨é¡¹ç›®è¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜è¯¥å¦‚ä½•å»åšå‘¢ï¼Ÿè¿™é‡Œåªæä¾›äº†æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³åŠæ³•ã€‚éœ€è¦åœ¨ <code>AppServiceProvider</code> ä¸­åŠ å…¥è¯¥æ–¹æ³•å°±å¯ä»¥äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">protected function setAuthHeader()</span><br><span class="line">&#123;</span><br><span class="line">    $chain &#x3D; $this-&gt;app[&#39;tymon.jwt.parser&#39;]-&gt;getChain();</span><br><span class="line"></span><br><span class="line">    $chain[0] &#x3D; $chain[0]-&gt;setHeaderPrefix(&#39;é¡¹ç›®çš„ token å‰ç¼€&#39;)-&gt;setHeaderName(&#39;é¡¹ç›®çš„å¤´ä¿¡æ¯ key&#39;);</span><br><span class="line"></span><br><span class="line">    $this-&gt;app[&#39;tymon.jwt.parser&#39;]-&gt;setChain($chain);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æœ‰æ›´å¥½çš„åŠæ³•å¯ä»¥æä¾›ï¼Œæ¬¢è¿ç•™è¨€æˆ–è€…æ”¹è¿›ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;è‡ªå®šä¹‰è®¤è¯å¤´&quot;&gt;&lt;a href=&quot;#è‡ªå®šä¹‰è®¤è¯å¤´&quot; class=&quot;headerlink&quot; title=&quot;è‡ªå®šä¹‰è®¤è¯å¤´&quot;&gt;&lt;/a&gt;è‡ªå®šä¹‰è®¤è¯å¤´&lt;/h2&gt;&lt;p&gt;é¡¹ç›®ä½¿ç”¨çš„&lt;code&gt;tymon/jwt-auth&lt;/code&gt;åŒ…ä½œä¸º &lt;code&gt;token&lt;/code&gt;
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://njphper.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="laravel" scheme="https://njphper.com/tags/laravel/"/>
    
      <category term="jwt" scheme="https://njphper.com/tags/jwt/"/>
    
  </entry>
  
  <entry>
    <title>Go Modules è¯¦è§£ä½¿ç”¨</title>
    <link href="https://njphper.com/posts/go-module/"/>
    <id>https://njphper.com/posts/go-module/</id>
    <published>2019-04-09T00:00:00.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><p>è‡ªä» <code>Go</code> å®˜æ–¹ä»å»å¹´æ¨å‡º 1.11 ä¹‹åï¼Œå¢åŠ æ–°çš„ä¾èµ–ç®¡ç†æ¨¡å—å¹¶ä¸”æ›´åŠ æ˜“äºç®¡ç†é¡¹ç›®ä¸­æ‰€éœ€è¦çš„æ¨¡å—ã€‚æ¨¡å—æ˜¯å­˜å‚¨åœ¨æ–‡ä»¶æ ‘ä¸­çš„ Go åŒ…çš„é›†åˆï¼Œå…¶æ ¹ç›®å½•ä¸­åŒ…å« go.mod æ–‡ä»¶ã€‚ go.mod æ–‡ä»¶å®šä¹‰äº†æ¨¡å—çš„æ¨¡å—è·¯å¾„ï¼Œå®ƒä¹Ÿæ˜¯ç”¨äºæ ¹ç›®å½•çš„å¯¼å…¥è·¯å¾„ï¼Œä»¥åŠå®ƒçš„ä¾èµ–æ€§è¦æ±‚ã€‚æ¯ä¸ªä¾èµ–æ€§è¦æ±‚éƒ½è¢«å†™ä¸ºæ¨¡å—è·¯å¾„å’Œç‰¹å®šè¯­ä¹‰ç‰ˆæœ¬ã€‚</p><p>ä» Go 1.11 å¼€å§‹ï¼ŒGo å…è®¸åœ¨ $GOPATH/src å¤–çš„ä»»ä½•ç›®å½•ä¸‹ä½¿ç”¨ go.mod åˆ›å»ºé¡¹ç›®ã€‚åœ¨ $GOPATH/src ä¸­ï¼Œä¸ºäº†å…¼å®¹æ€§ï¼ŒGo å‘½ä»¤ä»ç„¶åœ¨æ—§çš„ GOPATH æ¨¡å¼ä¸‹è¿è¡Œã€‚ä» Go 1.13 å¼€å§‹ï¼Œæ¨¡å—æ¨¡å¼å°†æˆä¸ºé»˜è®¤æ¨¡å¼ã€‚</p><p>æœ¬æ–‡å°†ä»‹ç»ä½¿ç”¨æ¨¡å—å¼€å‘ Go ä»£ç æ—¶å‡ºç°çš„ä¸€ç³»åˆ—å¸¸è§æ“ä½œï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—ã€‚</li><li>æ·»åŠ ä¾èµ–é¡¹ã€‚</li><li>å‡çº§ä¾èµ–é¡¹ã€‚</li><li>åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–é¡¹ã€‚</li></ul><p>ä¸‹é¢ä½¿ç”¨çš„æ¡ˆä¾‹éƒ½æ˜¯ä»¥ <code>GIN</code> æ¨¡å—ä¸ºä¾‹ã€‚<br>åœ¨è¿™ä¹‹å‰å‘¢ï¼Œéœ€è¦å…ˆè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GO111MODULE=on</span><br><span class="line"><span class="built_in">export</span> GOPROXY=https://goproxy.io // è®¾ç½®ä»£ç†</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—"><a href="#åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—"></a>åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—</h3><p>ä½ å¯ä»¥åœ¨   $GOPATH/src ä¹‹å¤–çš„ä»»ä½•åœ°æ–¹åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•ã€‚æ¯”å¦‚ï¼š</p><blockquote><p>mkdir backend &amp;&amp; cd backend</p></blockquote><p>ç„¶ååˆå§‹åŒ– <code>go mod init backend</code>ï¼ŒæˆåŠŸä¹‹åä½ ä¼šå‘ç°ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ª <code>go.mod</code> æ–‡ä»¶.</p><blockquote><p>$ cat go.mod </p><p>å†…å®¹å¦‚ä¸‹</p><p>module backend</p><p> go 1.12</p></blockquote><h3 id="æ·»åŠ ä¾èµ–é¡¹"><a href="#æ·»åŠ ä¾èµ–é¡¹" class="headerlink" title="æ·»åŠ ä¾èµ–é¡¹"></a>æ·»åŠ ä¾èµ–é¡¹</h3><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ main.go ç„¶ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼Œè¿™é‡Œç›´æ¥ import äº† gin çš„ä¾èµ–åŒ…ã€‚</p><blockquote><p>vim main.go</p></blockquote><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.GET(<span class="string">"/ping"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line"><span class="string">"message"</span>: <span class="string">"pong"</span>,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">r.Run() <span class="comment">// listen and serve on 0.0.0.0:8080</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>go build ä¹‹åï¼Œä¼šåœ¨ go.mod å¼•å…¥æ‰€éœ€è¦çš„ä¾èµ–åŒ…ã€‚ä¹‹åå†æ¥çœ‹çœ‹ go.mod æ–‡ä»¶çš„æƒ…å†µã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module backend</span><br><span class="line"></span><br><span class="line">go 1.12</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">github.com/gin-contrib/sse v0.0.0-20190301062529-5545eab6dad3 // indirect</span><br><span class="line">github.com/gin-gonic/gin v1.3.0</span><br><span class="line">github.com/golang/protobuf v1.3.1 // indirect</span><br><span class="line">github.com/mattn/go-isatty v0.0.7 // indirect</span><br><span class="line">github.com/ugorji/go v1.1.4 // indirect</span><br><span class="line">gopkg.in/go-playground/validator.v8 v8.18.2 // indirect</span><br><span class="line">gopkg.in/yaml.v2 v2.2.2 // indirect</span><br></pre></td></tr></table></figure><p>require å°±æ˜¯ gin æ¡†æ¶æ‰€éœ€è¦çš„æ‰€æœ‰ä¾èµ–åŒ… å¹¶ä¸”åœ¨æ¯ä¸ªä¾èµ–åŒ…çš„åé¢å·²ç»è¡¨æ˜äº†ç‰ˆæœ¬å·</p><h3 id="å‡çº§ä¾èµ–é¡¹"><a href="#å‡çº§ä¾èµ–é¡¹" class="headerlink" title="å‡çº§ä¾èµ–é¡¹"></a>å‡çº§ä¾èµ–é¡¹</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ä»¥ä¸‹æˆ‘ä»¬ä½¿ç”¨åˆ°çš„ä¾èµ–åˆ—è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; go list -m all</span><br><span class="line">&#x2F;&#x2F; ä½ ä¼šçœ‹åˆ°æ‰€æœ‰é¡¹ç›®ä½¿ç”¨çš„ä¾èµ–åŒ…</span><br><span class="line">backend</span><br><span class="line">github.com&#x2F;gin-contrib&#x2F;sse v0.0.0-20190301062529-5545eab6dad3</span><br><span class="line">github.com&#x2F;gin-gonic&#x2F;gin v1.3.0</span><br><span class="line">github.com&#x2F;golang&#x2F;protobuf v1.3.1</span><br><span class="line">github.com&#x2F;mattn&#x2F;go-isatty v0.0.7</span><br><span class="line">github.com&#x2F;ugorji&#x2F;go v1.1.4</span><br><span class="line">golang.org&#x2F;x&#x2F;sys v0.0.0-20190222072716-a9d3bda3a223</span><br><span class="line">gopkg.in&#x2F;check.v1 v0.0.0-20161208181325-20d25e280405</span><br><span class="line">gopkg.in&#x2F;go-playground&#x2F;validator.v8 v8.18.2</span><br><span class="line">gopkg.in&#x2F;yaml.v2 v2.2.2</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿™é‡Œä½¿ç”¨çš„æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œæ— æ³•å‡çº§ï¼Œæ‰€ä»¥è¿™é‡Œç»™å‡ºä¸€ä¸ªå›é€€çš„ä¾‹å­ã€‚å°† GIN æ¡†æ¶çš„ç‰ˆæœ¬å›é€€åˆ°ä¸Šä¸ªç‰ˆæœ¬ã€‚è¿™é‡Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤æŸ¥çœ‹ä¾èµ–çš„ç‰ˆæœ¬å†å²ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; go list -m -versions github.com&#x2F;gin-gonic&#x2F;gin</span><br><span class="line">&#x2F;&#x2F; å°†ä¼šåˆ—å‡º Gin ç‰ˆæœ¬å†å²</span><br><span class="line">github.com&#x2F;gin-gonic&#x2F;gin v1.1.1 v1.1.2 v1.1.3 v1.1.4 v1.3.0</span><br></pre></td></tr></table></figure><p>å°†ç‰ˆæœ¬æ›´æ–°åˆ°ä¸Šä¸ªç‰ˆæœ¬ï¼Œè¿™é‡Œåªæ˜¯ä¸ªæ¼”ç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; go get github.com&#x2F;gin-gonic&#x2F;gin@v1.1.4 &#x2F;&#x2F; åªéœ€è¦åœ¨ä¾èµ–åé¢åŠ ä¸Š @version å°±å¯ä»¥äº†</span><br><span class="line">&gt; go list -m all</span><br><span class="line">&#x2F;&#x2F; çœ‹åˆ°äº†ç‰ˆæœ¬å˜åŒ–</span><br><span class="line">github.com&#x2F;gin-gonic&#x2F;gin v1.1.4</span><br></pre></td></tr></table></figure><p>æˆ–è€…å¯ä»¥ä½¿ç”¨ <code>go mod</code>æ¥è¿›è¡Œç‰ˆæœ¬çš„åˆ‡æ¢, è¿™æ ·å°±éœ€è¦ä¸¤ä¸ªæ­¥éª¤äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; go mod edit -require=<span class="string">"github.com/gin-gonic/gin@v1.1.4"</span> // ä¿®æ”¹ go.mod æ–‡ä»¶</span><br><span class="line">&gt; go tidy //ä¸‹è½½æ›´æ–°ä¾èµ–</span><br></pre></td></tr></table></figure><p><code>go.tidy</code> ä¼šè‡ªåŠ¨æ¸…ç†æ‰ä¸éœ€è¦çš„ä¾èµ–é¡¹ï¼ŒåŒæ—¶å¯ä»¥å°†ä¾èµ–é¡¹æ›´æ–°åˆ°å½“å‰ç‰ˆæœ¬</p><p>ä½¿ç”¨èµ·æ¥è¿™æ˜¯ä¸€ä¸ªå¾ˆç®€å•è¿‡ç¨‹ï¼Œåªéœ€è¦å‡ ä¸ªå‘½ä»¤ï¼Œä½ ä¾¿å¯ä»¥çŸ¥é“ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥åŠè‡ªç”±é€‰æ‹©å®‰è£…çš„ç‰ˆæœ¬ï¼Œä¸€åˆ‡éƒ½å˜å¾—è¿™ä¹ˆç®€å•ã€‚</p><h3 id="åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–é¡¹"><a href="#åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–é¡¹" class="headerlink" title="åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–é¡¹"></a>åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–é¡¹</h3><p>å¦‚æœä½ åœ¨é¡¹ç›®è¿‡ç¨‹éœ€è¦ç§»é™¤ä¸€äº›ä¸éœ€è¦çš„ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;go mod tidy</span><br></pre></td></tr></table></figure><p>æ›´å¤šå…³äº go mod çš„ä½¿ç”¨å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;$ go mod</span><br><span class="line">The commands are:</span><br><span class="line"></span><br><span class="line">        download    download modules to local cache</span><br><span class="line">        edit        edit go.mod from tools or scripts</span><br><span class="line">        graph       print module requirement graph</span><br><span class="line">        init        initialize new module in current directory</span><br><span class="line">        tidy        add missing and remove unused modules</span><br><span class="line">        vendor      make vendored copy of dependencies</span><br><span class="line">        verify      verify dependencies have expected content</span><br><span class="line">        why         explain why packages or modules are needed</span><br></pre></td></tr></table></figure><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>Go Module æ˜¯ Go ä¾èµ–ç®¡ç†çš„æœªæ¥ã€‚ ç›®å‰åªæœ‰ 1.11 å’Œ 1.12 ç‰ˆæœ¬æ”¯æŒè¯¥åŠŸèƒ½ï¼Œä»‹ç»äº† Go ä¾èµ–ç®¡ç†çš„åŠŸèƒ½ã€‚æ›´å¤šçš„åŠŸèƒ½ä¼šåœ¨ä»¥åè¡¥å……ã€‚ä¹Ÿæ¬¢è¿è¡¥å……å®Œå–„ã€‚æœ€åå¦‚æœä½ æ˜¯ä½¿ç”¨ <code>Goland</code>, è¯·ç§»æ­¥è¿™é‡Œ<a href="https://blog.jetbrains.com/go/2019/01/22/working-with-go-modules/" target="_blank" rel="noopener">Working with Go Modules</a>é˜…è¯»å…³äºä½¿ç”¨ Modules å¼€å‘</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Module&quot;&gt;&lt;a href=&quot;#Module&quot; class=&quot;headerlink&quot; title=&quot;Module&quot;&gt;&lt;/a&gt;Module&lt;/h2&gt;&lt;p&gt;è‡ªä» &lt;code&gt;Go&lt;/code&gt; å®˜æ–¹ä»å»å¹´æ¨å‡º 1.11 ä¹‹åï¼Œå¢åŠ æ–°çš„ä¾èµ–ç®¡ç†æ¨¡å—å¹¶ä¸”æ›´åŠ æ˜“äºç®¡ç†é¡¹
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://njphper.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="go" scheme="https://njphper.com/tags/go/"/>
    
      <category term="go modules" scheme="https://njphper.com/tags/go-modules/"/>
    
  </entry>
  
  <entry>
    <title>Go é™·é˜±ä¹‹ for å¾ªç¯è¿­ä»£å˜é‡</title>
    <link href="https://njphper.com/posts/go-for-trap/"/>
    <id>https://njphper.com/posts/go-for-trap/</id>
    <published>2019-04-08T20:26:51.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ•è·è¿­ä»£å˜é‡"><a href="#æ•è·è¿­ä»£å˜é‡" class="headerlink" title="æ•è·è¿­ä»£å˜é‡"></a>æ•è·è¿­ä»£å˜é‡</h2><p>è¿™æ˜¯åœ¨å­¦ä¹  <strong>Go ç¨‹åºè®¾è®¡</strong> ä¸­é‡åˆ°çš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªè­¦å‘Šã€‚è¿™æ˜¯ä¸ª Go è¯­è¨€çš„è¯æ³•ä½œç”¨åŸŸè§„åˆ™çš„é™·é˜±ã€‚çœ‹å®Œä¹‹åæ„Ÿè§‰æ˜¯çœŸçš„ä¸€ä¸ªæ¯”è¾ƒè®©äººç–‘æƒ‘å›°æƒ‘çš„åœ°æ–¹ã€‚æ‰€ä»¥ç‰¹åœ°è®°å½•ä¸€ä¸‹ã€‚ç”±æ ‡é¢˜å°±å¯ä»¥çŸ¥é“äº†ï¼Œè¿­ä»£å˜é‡ï¼Œè‚¯å®šæ˜¯åœ¨ <code>for</code> ä¸­é‡åˆ°çš„é—®é¢˜ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜ä¸€ä¸‹è¿™ä¸ªé—®é¢˜æ‰€åœ¨ã€‚</p><p>çœ‹ä¸€æ®µç®€å•çš„ä»£ç ï¼Œ é¦–å…ˆæ˜¯é”™è¯¯çš„ç¤ºä¾‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice []<span class="function"><span class="keyword">func</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">sli := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line"><span class="keyword">for</span> _, v := <span class="keyword">range</span> sli &#123;</span><br><span class="line">fmt.Println(&amp;v)</span><br><span class="line">slice = <span class="built_in">append</span>(slice, <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">fmt.Println(v * v) <span class="comment">// ç›´æ¥æ‰“å°ç»“æœ</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, val  := <span class="keyword">range</span> slice &#123;</span><br><span class="line">val()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º 25 25 25 25 25</span></span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½ä¼šå¾ˆå¥‡æ€ªä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µ, ç»“æœä¸åº”è¯¥æ˜¯ <code>1, 4, 9, 16, 25</code> å—ï¼Ÿå…¶å®åŸå› æ˜¯å¾ªç¯å˜é‡çš„ä½œç”¨åŸŸçš„è§„åˆ™é™åˆ¶ã€‚åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œ<code>v</code> åœ¨ for å¾ªç¯å¼•è¿›çš„ä¸€ä¸ªå—ä½œç”¨åŸŸå†…è¿›è¡Œå£°æ˜ã€‚åœ¨å¾ªç¯é‡Œåˆ›å»ºçš„æ‰€æœ‰å‡½æ•°å˜é‡<code>å…±äº«ç›¸åŒçš„å˜é‡ï¼Œå°±æ˜¯ä¸€ä¸ªå¯è®¿é—®çš„å­˜å‚¨ä½ç½®ï¼Œè€Œä¸æ˜¯å›ºå®šçš„å€¼</code>ã€‚(ä½ ä¼šæƒŠå¥‡çš„å‘ç° <code>&amp;v</code> çš„å†…å­˜åœ°å€æ˜¯ä¸€æ ·çš„)</p><p>æ¨¡æ‹Ÿä¸€ä¸‹å®é™…çš„æƒ…å†µï¼Œå‡è®¾ v å˜é‡çš„åœ°å€åœ¨ 0x12345678 ä¸Šï¼Œ for å¾ªç¯åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å˜é‡å€¼éƒ½æ˜¯åœ¨è¿™åœ°å€ä¸Šè¿­ä»£çš„ã€‚å½“æœ€åè°ƒç”¨åŒ¿åå‡½æ•°çš„æ—¶å€™ï¼Œå–å€¼ä¹Ÿæ˜¯åœ¨è¿™å—åœ°å€ä¸Šã€‚æ‰€ä»¥æœ€åè¾“å‡ºçš„ç»“æœéƒ½æ˜¯è¿­ä»£çš„æœ€åä¸€ä¸ªå€¼ã€‚è‡³å°‘åœ¨ Go è¯­è¨€ä¸­æ˜¯ä¸ç”¨è´¨ç–‘çš„ã€‚è¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªé™·é˜±ï¼Œå¦‚æœä½ ä¸æ¸…æ¥šçš„è¯ï¼Œè‚¯å®šä¼šé‡åˆ°å‘ã€‚é‚£ä¸ªè¯¥å¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice []<span class="function"><span class="keyword">func</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">sli := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line"><span class="keyword">for</span> _, v := <span class="keyword">range</span> sli &#123;</span><br><span class="line">    temp := v <span class="comment">// å…¶å®å¾ˆç®€å• å¼•å…¥ä¸€ä¸ªä¸´æ—¶å±€éƒ¨å˜é‡å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±å¯ä»¥å°†æ¯æ¬¡çš„å€¼å­˜å‚¨åˆ°è¯¥å˜é‡åœ°å€ä¸Š</span></span><br><span class="line">fmt.Println(&amp;temp) <span class="comment">// è¿™é‡Œå†…å­˜åœ°å€æ˜¯ä¸åŒçš„</span></span><br><span class="line">slice = <span class="built_in">append</span>(slice, <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">fmt.Println(temp *  temp) <span class="comment">// ç›´æ¥æ‰“å°ç»“æœ</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, val  := <span class="keyword">range</span> slice &#123;</span><br><span class="line">val()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º 1, 4, 9, 16, 25 é¢„æœŸç»“æœ</span></span><br></pre></td></tr></table></figure><p>åªéœ€è¦å¼•å…¥ä¸€ä¸ªå±€éƒ¨å˜é‡ä¾¿å¯ä»¥è§£å†³äº†ï¼Œè¿™æ˜¯å¿…é¡»çš„ã€‚å¦åˆ™ä½ çš„ç¨‹åºå°†ä¸ä¼šæœ‰å¯é¢„æœŸçš„ç»“æœã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ•è·è¿­ä»£å˜é‡&quot;&gt;&lt;a href=&quot;#æ•è·è¿­ä»£å˜é‡&quot; class=&quot;headerlink&quot; title=&quot;æ•è·è¿­ä»£å˜é‡&quot;&gt;&lt;/a&gt;æ•è·è¿­ä»£å˜é‡&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯åœ¨å­¦ä¹  &lt;strong&gt;Go ç¨‹åºè®¾è®¡&lt;/strong&gt; ä¸­é‡åˆ°çš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªè­¦å‘Šã€‚è¿™æ˜¯ä¸ª Go 
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://njphper.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="go" scheme="https://njphper.com/tags/go/"/>
    
  </entry>
  
  <entry>
    <title>Go é™·é˜±ä¹‹ for å¾ªç¯è¿­ä»£å˜é‡</title>
    <link href="https://njphper.com/posts/go-for-error/"/>
    <id>https://njphper.com/posts/go-for-error/</id>
    <published>2019-04-06T21:33:37.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ•è·è¿­ä»£å˜é‡"><a href="#æ•è·è¿­ä»£å˜é‡" class="headerlink" title="æ•è·è¿­ä»£å˜é‡"></a>æ•è·è¿­ä»£å˜é‡</h2><p>è¿™æ˜¯åœ¨å­¦ä¹  <strong>Go ç¨‹åºè®¾è®¡</strong> ä¸­é‡åˆ°çš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªè­¦å‘Šã€‚è¿™æ˜¯ä¸ª Go è¯­è¨€çš„è¯æ³•ä½œç”¨åŸŸè§„åˆ™çš„é™·é˜±ã€‚çœ‹å®Œä¹‹åæ„Ÿè§‰æ˜¯çœŸçš„ä¸€ä¸ªæ¯”è¾ƒè®©äººç–‘æƒ‘å›°æƒ‘çš„åœ°æ–¹ã€‚æ‰€ä»¥ç‰¹åœ°è®°å½•ä¸€ä¸‹ã€‚ç”±æ ‡é¢˜å°±å¯ä»¥çŸ¥é“äº†ï¼Œè¿­ä»£å˜é‡ï¼Œè‚¯å®šæ˜¯åœ¨ <code>for</code> ä¸­é‡åˆ°çš„é—®é¢˜ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜ä¸€ä¸‹è¿™ä¸ªé—®é¢˜æ‰€åœ¨ã€‚</p><p>çœ‹ä¸€æ®µç®€å•çš„ä»£ç ï¼Œ é¦–å…ˆæ˜¯é”™è¯¯çš„ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var slice []func()</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">sli :&#x3D; []int&#123;1, 2, 3, 4, 5&#125;</span><br><span class="line">for _, v :&#x3D; range sli &#123;</span><br><span class="line">fmt.Println(&amp;v)</span><br><span class="line">slice &#x3D; append(slice, func()&#123;</span><br><span class="line">fmt.Println(v * v) &#x2F;&#x2F; ç›´æ¥æ‰“å°ç»“æœ</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for _, val  :&#x3D; range slice &#123;</span><br><span class="line">val()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; è¾“å‡º 25 25 25 25 25</span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½ä¼šå¾ˆå¥‡æ€ªä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µ, ç»“æœä¸åº”è¯¥æ˜¯ <code>1, 4, 9, 16, 25</code> å—ï¼Ÿå…¶å®åŸå› æ˜¯å¾ªç¯å˜é‡çš„ä½œç”¨åŸŸçš„è§„åˆ™é™åˆ¶ã€‚åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œ<code>v</code> åœ¨ for å¾ªç¯å¼•è¿›çš„ä¸€ä¸ªå—ä½œç”¨åŸŸå†…è¿›è¡Œå£°æ˜ã€‚åœ¨å¾ªç¯é‡Œåˆ›å»ºçš„æ‰€æœ‰å‡½æ•°å˜é‡<code>å…±äº«ç›¸åŒçš„å˜é‡ï¼Œå°±æ˜¯ä¸€ä¸ªå¯è®¿é—®çš„å­˜å‚¨ä½ç½®ï¼Œè€Œä¸æ˜¯å›ºå®šçš„å€¼</code>ã€‚(ä½ ä¼šæƒŠå¥‡çš„å‘ç° <code>&amp;v</code> çš„å†…å­˜åœ°å€æ˜¯ä¸€æ ·çš„)</p><p>æ¨¡æ‹Ÿä¸€ä¸‹å®é™…çš„æƒ…å†µï¼Œå‡è®¾ v å˜é‡çš„åœ°å€åœ¨ 0x12345678 ä¸Šï¼Œ for å¾ªç¯åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å˜é‡å€¼éƒ½æ˜¯åœ¨è¿™åœ°å€ä¸Šè¿­ä»£çš„ã€‚å½“æœ€åè°ƒç”¨åŒ¿åå‡½æ•°çš„æ—¶å€™ï¼Œå–å€¼ä¹Ÿæ˜¯åœ¨è¿™å—åœ°å€ä¸Šã€‚æ‰€ä»¥æœ€åè¾“å‡ºçš„ç»“æœéƒ½æ˜¯è¿­ä»£çš„æœ€åä¸€ä¸ªå€¼ã€‚è‡³å°‘åœ¨ Go è¯­è¨€ä¸­æ˜¯ä¸ç”¨è´¨ç–‘çš„ã€‚è¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªé™·é˜±ï¼Œå¦‚æœä½ ä¸æ¸…æ¥šçš„è¯ï¼Œè‚¯å®šä¼šé‡åˆ°å‘ã€‚é‚£ä¸ªè¯¥å¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var slice []func()</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">sli :&#x3D; []int&#123;1, 2, 3, 4, 5&#125;</span><br><span class="line">for _, v :&#x3D; range sli &#123;</span><br><span class="line">    temp :&#x3D; v &#x2F;&#x2F; å…¶å®å¾ˆç®€å• å¼•å…¥ä¸€ä¸ªä¸´æ—¶å±€éƒ¨å˜é‡å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±å¯ä»¥å°†æ¯æ¬¡çš„å€¼å­˜å‚¨åˆ°è¯¥å˜é‡åœ°å€ä¸Š</span><br><span class="line">fmt.Println(&amp;temp) &#x2F;&#x2F; è¿™é‡Œå†…å­˜åœ°å€æ˜¯ä¸åŒçš„</span><br><span class="line">slice &#x3D; append(slice, func()&#123;</span><br><span class="line">fmt.Println(temp *  temp) &#x2F;&#x2F; ç›´æ¥æ‰“å°ç»“æœ</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for _, val  :&#x3D; range slice &#123;</span><br><span class="line">val()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; è¾“å‡º 1, 4, 9, 16, 25 é¢„æœŸç»“æœ</span><br></pre></td></tr></table></figure><p>åªéœ€è¦å¼•å…¥ä¸€ä¸ªå±€éƒ¨å˜é‡ä¾¿å¯ä»¥è§£å†³äº†ï¼Œè¿™æ˜¯å¿…é¡»çš„ã€‚å¦åˆ™ä½ çš„ç¨‹åºå°†ä¸ä¼šæœ‰å¯é¢„æœŸçš„ç»“æœã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ•è·è¿­ä»£å˜é‡&quot;&gt;&lt;a href=&quot;#æ•è·è¿­ä»£å˜é‡&quot; class=&quot;headerlink&quot; title=&quot;æ•è·è¿­ä»£å˜é‡&quot;&gt;&lt;/a&gt;æ•è·è¿­ä»£å˜é‡&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯åœ¨å­¦ä¹  &lt;strong&gt;Go ç¨‹åºè®¾è®¡&lt;/strong&gt; ä¸­é‡åˆ°çš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªè­¦å‘Šã€‚è¿™æ˜¯ä¸ª Go 
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://njphper.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="go" scheme="https://njphper.com/tags/go/"/>
    
  </entry>
  
  <entry>
    <title>Waiting(TTFB) ç­‰å¾…æ—¶é—´è¿‡é•¿</title>
    <link href="https://njphper.com/posts/waitting-ttfb-to-long/"/>
    <id>https://njphper.com/posts/waitting-ttfb-to-long/</id>
    <published>2019-02-21T22:13:17.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p> é—®é¢˜æ˜¯åœ¨æˆ‘ä¿®æ”¹åå°çš„æ—¶å€™å‡ºç°ï¼Œå› ä¸ºæœ€è¿‘è¦ç»™æˆ‘çš„<a href="https://gitee.com/lovephp/thinkphp51_backstage" target="_blank" rel="noopener">åå°ç®¡ç†</a>æ¢åå°çš®è‚¤ï¼Œæ‰€ä»¥è¦é‡å†™ä¸€ä¸‹åå°é¡µé¢ã€‚æ¢å®Œä¹‹åå‘¢ï¼Œå‘ç°æ¯æ¬¡è¯·æ±‚é¡µé¢éƒ½ç‰¹ä¹ˆçš„é•¿ï¼Œç„¶åå°±æ‰“æ‰“å¼€ <code>Chrome</code> çš„è°ƒè¯•æŸ¥çœ‹ï¼Œ å‘ç°  <code>Waiting(TTFb)</code> æ—¶é—´ç‰¹åˆ«é•¿ï¼Œå‡ ä¹æ‰€æœ‰å æ®äº†æ‰€æœ‰çš„è¯·æ±‚æ—¶é—´ã€‚</p><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><ul><li><p>åˆ‡æ¢æµè§ˆå™¨ï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯æµè§ˆå™¨é—®é¢˜ï¼Œæ‰€ä»¥åˆ‡æ¢äº†  <code>Firefox</code>ï¼Œ å‘ç°ç»“æœæ˜¯ä¸€æ ·</p></li><li><p>åŸŸåè®¿é—®çš„é—®é¢˜ï¼Œæˆ‘æ˜¯é€šè¿‡æœ¬åœ° <code>ip</code> åœ°å€è®¿é—®ï¼Œåˆ‡æ¢åˆ° <code>Apache</code> æœåŠ¡å™¨ä¹‹åå‘ç°ç»“æœä¹Ÿæ˜¯ä¸€æ ·</p></li><li><p>æ€€ç–‘æ˜¯é™æ€èµ„æºåŠ è½½ï¼Œå‘ç°é™æ€èµ„æºåŠ è½½éƒ½éå¸¸çš„å¿«ï¼Œæ’é™¤</p><p>åŸºæœ¬çŒœæµ‹ç»“æŸå‘ç°ï¼Œæˆ‘å‘ç°ä»€ä¹ˆæ— æ³•è§£å†³é—®é¢˜ï¼ŒæŸ¥çœ‹ tp çš„æ—¥å¿—æ–‡ä»¶ï¼Œå‘ç°äº†é—®é¢˜ï¼Œåœ¨ <code>Mysql Db Connect</code> çš„æ—¶å€™ï¼Œè¿æ¥æ—¶é—´éå¸¸çš„é•¿ï¼Œé•¿è¾¾ <code>1s</code>  ä»¥ä¸Šï¼Œé—®é¢˜å°±å‡ºç°åœ¨è¿™é‡Œã€‚ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ</p><p>æˆ‘å‘ç° <code>host</code>  çš„åœ°å€ä¸æ˜¯ <code>127.0.0.1</code>  è€Œæ˜¯ <code>localhost</code></p></li></ul><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p><code>host</code> æ–‡ä»¶æ·»åŠ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 localhost</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿåªéœ€è¦ä¸¤ä¸ªæ­¥éª¤å°±å¯ä»¥çœ‹å‡ºæ¥äº†ã€‚åœ¨æ²¡æœ‰é…ç½®ä¸Šè¿°é…ç½®ä¹‹å‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping localhost</span><br></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°ä»–æŒ‡å‘çš„æ˜¯ <code>ipv6 ï¼šï¼š1</code> çš„åœ°å€ï¼Œ é—®é¢˜å°±æ˜¯å‡ºåœ¨è¿™é‡Œã€‚èµ°çš„æ˜¯ <code>IPV6</code>ã€‚æ”¹æˆ <code>IPV4</code> çš„åœ°å€å°±å¯ä»¥äº† </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¤ç°&quot;&gt;&lt;a href=&quot;#å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;å¤ç°&quot;&gt;&lt;/a&gt;å¤ç°&lt;/h2&gt;&lt;p&gt; é—®é¢˜æ˜¯åœ¨æˆ‘ä¿®æ”¹åå°çš„æ—¶å€™å‡ºç°ï¼Œå› ä¸ºæœ€è¿‘è¦ç»™æˆ‘çš„&lt;a href=&quot;https://gitee.com/lovephp/thinkphp51_
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç½‘ç»œè¯·æ±‚" scheme="https://njphper.com/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡åˆ†äº« JSSDK å®ç°</title>
    <link href="https://njphper.com/posts/wx-sdk-share/"/>
    <id>https://njphper.com/posts/wx-sdk-share/</id>
    <published>2018-12-12T22:18:36.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å…¬å¸è¦åšä¸ªå¾®ä¿¡åˆ†äº«åŠŸèƒ½ï¼Œè®°å½•ä¸‹æ¥ä»¥ä¾¿åæ¥å¤åˆ¶ç²˜è´´ï¼Œå“ˆå“ˆå“ˆã€‚<br>åŸè°…æˆ‘ï¼Œæˆ‘åœ¨åšè¿™ä¸ªä¹‹å‰ä»ç½‘ä¸Šçš„ç¡®å¤åˆ¶ç²˜è´´äº†ï¼Œæœ€åå‘ç°éƒ½æ²¡æ³•ç”¨ï¼Œå“ˆå“ˆï¼Œåªèƒ½è‡ªå·±çœ‹æ¥å£æ–‡æ¡£äº†ã€‚åœ¨è¿™ä¹‹å‰ï¼Œé¦–å…ˆä½ è¦è·å– <code>appid</code> å’Œ appSecretï¼Œç„¶åè¿˜è¦é…ç½® <code>JS</code> <strong>å®‰å…¨åŸŸå</strong>ï¼Œè¿˜æœ‰å°±æ˜¯ <code>IP</code> <strong>ç™½åå•</strong>ï¼Œè¿™äº›æˆ‘å°±ä¸è¯´äº†ï¼Œæœ‰äº†å¾®ä¿¡å…¬ä¼—å·åå°è½»æ¾æå®š</p><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><p>æˆ‘ä½¿ç”¨çš„æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼Œä¸è¯´å¤§å®¶éƒ½çŸ¥é“æ˜¯ä»€ä¹ˆäº†å§ï¼å“ˆå“ˆå“ˆï¼Œæˆ‘å°±ç›´æ¥ä¸Šä»£ç äº†ï¼Œæ³¨æ„ç‚¹åœ¨ä»£ç é‡Œé¢çœ‹ã€‚æ³¨æ„é¡¹ç›®ç”¨çš„<code>thinkphp</code> æ¡†æ¶ï¼Œæ‰€ä»¥ <code>Cache</code> æ ¹æ®å®é™…ä½¿ç”¨ï¼Œä¸èƒ½ä¸€è‚¡è„‘çš„ç²˜è´´å•Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">use Think\Cache;</span><br><span class="line"></span><br><span class="line">class WeChat</span><br><span class="line">&#123;</span><br><span class="line">  &#x2F;&#x2F; ä½ çš„ appid</span><br><span class="line">    private $appId &#x3D; &#39;&#39;; </span><br><span class="line"> &#x2F;&#x2F; ç§˜é’¥</span><br><span class="line">    private $appSecret &#x3D; &#39;&#39;; </span><br><span class="line"> &#x2F;&#x2F; è·å– token çš„ url</span><br><span class="line">    private $getAccessTokenUrl &#x3D; &#39;https:&#x2F;&#x2F;api.weixin.qq.com&#x2F;cgi-bin&#x2F;token&#39;; </span><br><span class="line">&#x2F;&#x2F; è·å– jsticket çš„ url</span><br><span class="line">    private $getJsTicketUrl &#x3D; &#39;https:&#x2F;&#x2F;api.weixin.qq.com&#x2F;cgi-bin&#x2F;ticket&#x2F;getticket&#39;;</span><br><span class="line"></span><br><span class="line">    private $cacheLiefTime &#x3D; 3600;</span><br><span class="line"></span><br><span class="line">    private $cacheKey      &#x3D; &#39;ticket&#39;;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * è·å–ç­¾å</span><br><span class="line">     *</span><br><span class="line">     * @time at 2018å¹´12æœˆ10æ—¥</span><br><span class="line">     * @param $url</span><br><span class="line">     * @return array</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public function getSignature($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $nonceStr &#x3D; $this-&gt;createNonceStr(18);</span><br><span class="line">        $timeStamp &#x3D; time();</span><br><span class="line">        $params &#x3D; [</span><br><span class="line">            &#39;jsapi_ticket&#39; &#x3D;&gt; $this-&gt;getJsTicket(),</span><br><span class="line">            &#39;noncestr&#39;     &#x3D;&gt; $nonceStr,</span><br><span class="line">            &#39;timestamp&#39;    &#x3D;&gt; $timeStamp,</span><br><span class="line">        ];</span><br><span class="line">  &#x2F;&#x2F; åªæœ‰å”¯ä¸€çš„æ³¨æ„ç‚¹ï¼Œå°±æ˜¯ä¸è¦æŠŠ url æ”¾åœ¨ http_build_query å‡½æ•°é‡Œé¢ï¼Œå®ƒä¼šè½¬ä¹‰</span><br><span class="line">&#x2F;&#x2F; éªŒè¯ä½ çš„ç­¾åè¯·åˆ°è¿™é‡Œ http:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;debug&#x2F;cgi-bin&#x2F;sandbox?t&#x3D;jsapisign</span><br><span class="line">        $signature &#x3D; sha1(http_build_query($params) . &#39;&amp;url&#x3D;&#39; . $url);</span><br><span class="line"></span><br><span class="line">        return [&#39;noncestr&#39; &#x3D;&gt; $nonceStr, &#39;timestamp&#39; &#x3D;&gt; $timeStamp, &#39;signature&#39; &#x3D;&gt; $signature, &#39;appid&#39; &#x3D;&gt; $this-&gt;appId];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * è·å– TOKEN</span><br><span class="line">     *</span><br><span class="line">     * @time at 2018å¹´12æœˆ10æ—¥</span><br><span class="line">     * @return void</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private function getAccessToken()</span><br><span class="line">    &#123;</span><br><span class="line">        $params &#x3D; [</span><br><span class="line">            &#39;grant_type&#39; &#x3D;&gt; &#39;client_credential&#39;,</span><br><span class="line">            &#39;appid&#39;      &#x3D;&gt; $this-&gt;appId,</span><br><span class="line">            &#39;secret&#39;     &#x3D;&gt; $this-&gt;appSecret,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $res &#x3D; $this-&gt;httpGet($this-&gt;getAccessTokenUrl .&#39;?&#39;.http_build_query($params));</span><br><span class="line">        $res &#x3D; json_decode($res, true);</span><br><span class="line">        if (isset($res[&#39;errcode&#39;])) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return $res[&#39;access_token&#39;];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * è·å–ç­¾å</span><br><span class="line">     *</span><br><span class="line">     * @time at 2018å¹´12æœˆ10æ—¥</span><br><span class="line">     * @return void</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private function getJsTicket()</span><br><span class="line">    &#123;</span><br><span class="line">       $ticket &#x3D; cache($this-&gt;cacheKey);</span><br><span class="line"></span><br><span class="line">        if ($ticket) &#123;</span><br><span class="line">            return $ticket;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $accessToken &#x3D; $this-&gt;getAccessToken();</span><br><span class="line"></span><br><span class="line">        $params &#x3D; [</span><br><span class="line">            &#39;access_token&#39; &#x3D;&gt; $accessToken,</span><br><span class="line">            &#39;type&#39;         &#x3D;&gt; &#39;jsapi&#39;,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if (!$accessToken) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        $res &#x3D; $this-&gt;httpGet($this-&gt;getJsTicketUrl .&#39;?&#39;.http_build_query($params));</span><br><span class="line">        $res &#x3D; json_decode($res, true);</span><br><span class="line"></span><br><span class="line">        if (isset($res[&#39;errcode&#39;]) &amp;&amp; $res[&#39;errcode&#39;]) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        Cache::remember($this-&gt;cacheKey, $res[&#39;ticket&#39;], $this-&gt;cacheLiefTime);</span><br><span class="line"></span><br><span class="line">        return $res[&#39;ticket&#39;];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function httpGet($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $curl &#x3D; curl_init();</span><br><span class="line">        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);</span><br><span class="line">        curl_setopt($curl, CURLOPT_TIMEOUT, 500);</span><br><span class="line">        curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, true);</span><br><span class="line">        curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2);</span><br><span class="line">        curl_setopt($curl, CURLOPT_URL, $url);</span><br><span class="line">        $res &#x3D; curl_exec($curl);</span><br><span class="line">        curl_close($curl);</span><br><span class="line"></span><br><span class="line">        return $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function createNonceStr($n)</span><br><span class="line">    &#123;</span><br><span class="line">        if (!is_numeric($n)) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        $str &#x3D; &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#39;;</span><br><span class="line">        $nonceStr &#x3D; &#39;&#39;;</span><br><span class="line">        $strLen &#x3D; strlen($str);</span><br><span class="line">        for ($i &#x3D; 1; $i &lt; intval($n); $i++) &#123;</span><br><span class="line">            $nonceStr .&#x3D; $str[rand(0, $strLen-1)];</span><br><span class="line">        &#125;</span><br><span class="line">        return $nonceStr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰å°"><a href="#å‰å°" class="headerlink" title="å‰å°"></a>å‰å°</h3><blockquote><p>å¼•å…¥ <a href="http://res2.wx.qq.com/open/js/jweixin-1.4.0.js" target="_blank" rel="noopener">http://res2.wx.qq.com/open/js/jweixin-1.4.0.js</a>  ç½‘ä¸Šéƒ½æ˜¯ 1.2.0ï¼ŒæŠ„çš„æˆ‘å¥½ç´¯</p></blockquote><h5 id="å‰ç«¯ä»£ç "><a href="#å‰ç«¯ä»£ç " class="headerlink" title="å‰ç«¯ä»£ç "></a>å‰ç«¯ä»£ç </h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; æ³¨æ„å¾®ä¿¡æ–‡æ¡£æåˆ° url ä¸å…è®¸å¸¦ # åé¢çš„å†…å®¹ï¼Œæ‰€ä»¥å°±åˆ†å‰²å§, è¿˜æœ‰ä¸‹é¢ä½ çœ‹ä¸€ä¸‹å°±æ‡‚äº†å§ã€‚</span><br><span class="line">&#x2F;&#x2F; å¾®ä¿¡å¥½å¤šæ¥å£éƒ½æ¢äº†ï¼Œä½¿ç”¨ä¹Ÿå’Œç½‘ä¸Šçš„ä¸€ç‚¹ä¹Ÿä¸ä¸€æ ·äº†ï¼Œæ‰€ä»¥å¦‚æœå½“ä½ çœ‹åˆ°è¿™ç¯‡æ–‡ç« æ–‡ç« ä½¿ç”¨ä¸èƒ½æˆåŠŸçš„æ—¶å€™ï¼Œå»ºè®®ä½ å»çœ‹å¾®ä¿¡æ–‡æ¡£, ä¸è¦å†æŠ„è¿™ä¸ªäº†ã€‚è¿˜æœ‰å°±æ˜¯è°ƒè¯•æœŸé—´æŠŠ debug å¼€ä¸‹æ¥ã€‚</span><br><span class="line">var url &#x3D; window.location.href.split(&#39;#&#39;)[0];</span><br><span class="line">    $.post(&quot;&#123;:url(&#39;Index&#x2F;getWxConfig&#39;)&#125;&quot;, &#123;&quot;url&quot;: url&#125;, function (response)&#123;</span><br><span class="line">        var params &#x3D; &#123;&#125;</span><br><span class="line">        params.debug &#x3D; false;</span><br><span class="line">        params.appId &#x3D; response.data.appid;</span><br><span class="line">        params.timestamp &#x3D; response.data.timestamp;</span><br><span class="line">        params.nonceStr &#x3D; response.data.noncestr;</span><br><span class="line">        params.signature &#x3D; response.data.signature;</span><br><span class="line">        params.jsApiList &#x3D; [&#39;updateAppMessageShareData&#39;,&#39;updateTimelineShareData&#39;];</span><br><span class="line">        wx.config(params);</span><br><span class="line">        wx.ready(function () &#123;</span><br><span class="line">            wx.updateAppMessageShareData(&#123;</span><br><span class="line">                title: &#39;æˆ‘å°±æ˜¯ä¸ä¿¡&#39;,</span><br><span class="line">                desc: &#39;å¾®ä¿¡åˆ†äº«æˆåŠŸäº†æ²¡&#39;,</span><br><span class="line">                link: url,</span><br><span class="line">                imgUrl: &#39;http:&#x2F;&#x2F;aaaa.gaiwenkeji.com&#x2F;data&#x2F;upload&#x2F;qrcode&#x2F;7.png?id&#x3D;1544524256&#39;,</span><br><span class="line">                type: &#39;link&#39;,</span><br><span class="line">                dataUrl: &#39;&#39;,</span><br><span class="line">            &#125;);</span><br><span class="line">            wx.updateTimelineShareData(&#123;</span><br><span class="line">                title: &#39;æˆ‘ç›¸ä¿¡äº†, èƒ½ä¸ä¿¡å—&#39;,</span><br><span class="line">                link: url,</span><br><span class="line">                imgUrl: &#39;http:&#x2F;&#x2F;aaaa.gaiwenkeji.com&#x2F;data&#x2F;upload&#x2F;qrcode&#x2F;7.png?id&#x3D;1544524256&#39;,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä¾¿æ˜¯å¾®ä¿¡åˆ†äº«çš„æ‰€æœ‰ä¸œè¥¿ï¼Œæ²¡æœ‰ä»€ä¹ˆå‘ã€‚å‘å°±æ˜¯æˆ‘æŠ„ç½‘ä¸Šçš„ã€‚è¿˜æœ‰å°±æ˜¯ç­¾å <code>URL</code> è½¬ä¹‰çš„ï¼Œå…¶ä»–å°±æ²¡å’¯ã€‚</p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>2018/12/24 æ–°çš„å¾®ä¿¡æ¥å£åœ¨å®‰å“ç³»ç»Ÿä¼šæ— æ•ˆï¼Œå»ºè®®ä½¿ç”¨è€æ¥å£ï¼ŒIOS ä¸Šå¯ä»¥ç»§ç»­ä½¿ç”¨æ–°çš„æ¥å£ </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘å…¬å¸è¦åšä¸ªå¾®ä¿¡åˆ†äº«åŠŸèƒ½ï¼Œè®°å½•ä¸‹æ¥ä»¥ä¾¿åæ¥å¤åˆ¶ç²˜è´´ï¼Œå“ˆå“ˆå“ˆã€‚&lt;br&gt;åŸè°…æˆ‘ï¼Œæˆ‘åœ¨åšè¿™ä¸ªä¹‹å‰ä»ç½‘ä¸Šçš„ç¡®å¤åˆ¶ç²˜è´´äº†ï¼Œæœ€åå‘ç°éƒ½æ²¡æ³•ç”¨ï¼Œå“ˆå“ˆï¼Œåªèƒ½è‡ªå·±çœ‹æ¥å£æ–‡æ¡£äº†ã€‚åœ¨è¿™ä¹‹å‰ï¼Œé¦–å…ˆä½ è¦è·å– &lt;code&gt;appid&lt;/code&gt; å’Œ appSecretï¼Œç„¶åè¿˜è¦é…ç½® &lt;code&gt;J
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="å¾®ä¿¡åˆ†äº«" scheme="https://njphper.com/tags/%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>v2ray æ›´å®‰å…¨çš„ä»£ç†æœåŠ¡</title>
    <link href="https://njphper.com/posts/v2ray/"/>
    <id>https://njphper.com/posts/v2ray/</id>
    <published>2018-12-05T22:45:35.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h3><p> ç”±äºæœ€è¿‘ä½¿ç”¨ vps è¿ç»­è¢«å°ç¦ï¼Œä¸çŸ¥æ˜¯å¦æ˜¯å› ä¸ºåˆ‡æ¢åˆ° SSR çš„ç¼˜æ•…ï¼Ÿæˆ‘ä»ç½‘ç»œä¸Šçœ‹åˆ°å¾ˆå¤šå…³äº SSR è¢«å°ç¦çš„æƒ…å†µï¼Œå¥½åƒæ˜¯ç”±äºå¢™ä¸éœ€è¦å»ç‰¹æ„ç ´è§£ä»€ä¹ˆåŠ å¯†ï¼Œè€Œæ˜¯æ ¹æ® SSR æŸäº›ç‰¹å¾å¯ä»¥å¤§æ¦‚ç‡æŸ¥å°ã€‚å¯¹äºæˆ‘è€Œè¨€ï¼Œæˆ‘è¿˜æ˜¯ä¿¡æœè¿™ç§è¯´æ³•ï¼Œå› ä¸ºåœ¨æˆ‘åˆ‡æ¢åˆ° SSR ä¹‹åä¸åˆ°ä¸‰å¤©æˆ‘çš„ä¸¤å°æœåŠ¡å™¨è¿ç»­è¢«å°ç¦äº†ï¼Œè¿™è®©æˆ‘ä¸çŸ¥æ‰€æªã€‚å› ä¸ºåœ¨è¿™ä¹‹å‰æ²¡å»å¥½å¥½äº†è§£å®é™…æƒ…å†µï¼Œæˆ‘é¢å¯¹è¿™ç§æƒ…å†µçœŸçš„æ˜¾å¾—å¾ˆæ— å¥ˆï¼Œå¥½å¥½åœ°ä¸¤å° VPS å±…ç„¶éƒ½è¢«å°äº†ï¼Œåªå¥½å¿ç—›åˆä¹°äº†ä¸€å°ã€‚</p><h3 id="å‘ç°-V2ray"><a href="#å‘ç°-V2ray" class="headerlink" title="å‘ç° V2ray"></a>å‘ç° V2ray</h3><p> åœ¨è®ºå›ä¸Šçœ‹åˆ°å¾ˆå¤šäººä¹Ÿé‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œå¾ˆå¤šéƒ½æ¨èä½¿ç”¨ V2rayï¼Œæ–°çš„åè®®ï¼Œä¼ªè£…ç¨‹åº¦é«˜ï¼Œå„ç§ä¼˜ç‚¹ã€‚è€Œä¸”ç°åœ¨ SS å’Œ SSR åœæ­¢æ›´æ–°äº†ï¼Œä» V2ray github ä¸Šæ¥çœ‹ï¼Œæ›´æ–°å¾ˆé¢‘ç¹ï¼Œè€Œä¸”åŠŸèƒ½ä¹Ÿåœ¨ä¸åœåœ°å¢åŠ ã€‚<br> å¯¹äºè¿™ä¸ªæ—¶å€™çš„æˆ‘ï¼Œå…¶å®å·²ç»ä¸åœ¨ä¹é€Ÿåº¦äº†ï¼Œæ›´åŠ åœ¨ä¹çš„æ˜¯å®‰å…¨å’Œé•¿ä¹…ï¼Œå› ä¸ºæˆ‘åªæ˜¯ç”¨æ¥æŸ¥æŸ¥èµ„æ–™ï¼ŒåŸºæœ¬å¾ˆå°‘çœ‹è§†é¢‘ï¼Œå¯¹äºé€Ÿåº¦è¦æ±‚ä¸é«˜ã€‚å½“ç„¶ç°åœ¨å·²ç»æ­å»ºçš„è¿™å°ä»£ç†é€Ÿåº¦è¿˜æ˜¯å¯ä»¥çš„ï¼Œæ²¹ç®¡çš„ 1080 å¾ˆæµç•…ã€‚è€Œä¸”å¥½å‡ ä¸ªäººåœ¨ç”¨ã€‚</p><h3 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h3><p> æœ¬èº« v2ray æœåŠ¡æ”¯æŒå¾ˆå¤šç§æ–¹æ¡ˆï¼Œå…·ä½“æœ‰å¤šå°‘æˆ‘éƒ½å¿˜äº†ã€‚æœ‰å…´è¶£çš„å¯ä»¥å»æŸ¥æŸ¥åšå®¢ã€‚è¿™é‡Œæˆ‘åªä»‹ç»æˆ‘æ­£åœ¨ä½¿ç”¨æ–¹æ¡ˆï¼Œä¹Ÿæ˜¯å¤§å®¶æ™®éè®¤å¯è€Œä¸”å®‰å…¨æ¯”è¾ƒé«˜çš„æ–¹æ¡ˆ ã€‚</p><blockquote><p>v2ray + nginx + websocket + tls</p></blockquote><p>å½“å‰ä½ é¦–å…ˆå¿…é¡»æ‹¥æœ‰ä¸€å° <code>VPS</code>ï¼Œæ¨èè‚¯å®šå°±æ˜¯æ¬ç“¦å·¥çš„ <code>KVM</code> æ¶æ„çš„äº†ã€‚å®‰è£…è¯·é€‰æ‹©å¸¦æœ‰ <code>BBR</code> çš„ç³»ç»Ÿã€‚<code>BBR</code> æ˜¯ç”± GOOGLE æå‡ºçš„ä¸€ä¸ªå¼€æº <code>TCP</code> æ‹¥å¡æ§åˆ¶çš„ç®—æ³•ã€‚è¿™é‡Œæœ‰ä¸€ç¯‡<a href="https://blog.csdn.net/dog250/article/details/52830576" target="_blank" rel="noopener">æ–‡ç« </a>ä½œäº†è¯¦ç»†çš„ä»‹ç»ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹ã€‚è¿˜æ˜¯ä½ å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªåŸŸåï¼Œè¿™æ˜¯å¿…é¡»çš„ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä½ å¯ä»¥å…ˆå…³é—­è¯¥é¡µé¢ï¼Œç”³è¯·å®Œå†æ¥çœ‹äº†ï¼Œæˆ–è€…æ‰¾ä¸€ä¸‹å…¶ä»–çš„ v2ray çš„è§£å†³æ–¹æ¡ˆäº†ã€‚<br>è¿™å¥—æ–¹æ¡ˆçš„æ€è·¯å°±æ˜¯åˆ©ç”¨ nginx ä½œä¸ºä¸­è½¬æ¥åšä¼ªè£…ã€‚ç›¸æ¯”äº SSR çš„ç›´è¿ï¼Œåœ¨ v2ray å®¢æˆ·ç«¯å‘å‡º ws çš„è¯·æ±‚åˆ° nginxï¼Œç„¶ååˆ©ç”¨ nginx çš„ä»£ç†ç›´æ¥è½¬å‘åˆ° v2ray çš„æœåŠ¡ä¸Šé¢ã€‚è¿™æ ·å°±å¯ä»¥å°†è¯·æ±‚ä¼ªè£…æˆæ­£å¸¸ ws çš„è¯·æ±‚ ã€‚</p><h3 id="å®‰è£…-ï¼ˆCentos7-ç³»ç»Ÿï¼‰"><a href="#å®‰è£…-ï¼ˆCentos7-ç³»ç»Ÿï¼‰" class="headerlink" title="å®‰è£… ï¼ˆCentos7 ç³»ç»Ÿï¼‰"></a>å®‰è£… ï¼ˆCentos7 ç³»ç»Ÿï¼‰</h3><h4 id="å®‰è£…-v2ray"><a href="#å®‰è£…-v2ray" class="headerlink" title="å®‰è£… v2ray"></a>å®‰è£… v2ray</h4><p>æˆ‘è¿˜æ˜¯æ¨èä¸€é”®è„šæœ¬ï¼Œè¿™ä¹Ÿæ˜¯ç”±å®˜æ–¹ç»´æŠ¤çš„ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºä½ æ²¡å¿…è¦å†å»è‡ªå·±æä»€ä¹ˆç¼–è¯‘å•¥çš„ï¼Œä¹Ÿæ²¡å¤šå¤§æ„ä¹‰ã€‚ç›®å‰è¿˜æ˜¯èƒ½æˆåŠŸå®‰å…¨èµ·æ¥ä¸ºä¸»ã€‚ä»¥åæœ‰å…´è¶£äº†å†å»ææä¹Ÿè¿˜è¡Œã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥äº†</p><blockquote><p>bash &lt;(curl -L -s <a href="https://install.direct/go.sh" target="_blank" rel="noopener">https://install.direct/go.sh</a>)</p></blockquote><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ§åˆ¶ v2ray æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start|restart|stop|status v2ray</span><br></pre></td></tr></table></figure><p>å…¶é…ç½®æ–‡ä»¶æ”¾åœ¨ <code>/etc/v2ray/config.json</code>ï¼Œæ˜¯ä¸€ä¸ª <code>Json</code> æ–‡ä»¶ï¼Œåœ¨ä½ å®‰è£…å®Œä¹‹åä¼šæœ‰ä¸€ä¸ªåˆå§‹åŒ–çš„ <code>Json</code> æ–‡ä»¶ï¼Œæ–‡ä»¶ä¼šæä¾›ä¸‰ä¸ªå¿…è¦çš„ä¿¡æ¯ <code>IP</code>ã€ç«¯å£ï¼ˆ<code>Port</code>ï¼‰ã€<code>idï¼ˆUUIDï¼‰</code>, å°¤å…¶æ˜¯è¿™ä¸ª UUIDï¼Œå¾ˆé‡è¦ã€‚å®¢æˆ·ç«¯ä¼šä½¿ç”¨åˆ°ï¼Œå¿…é¡»ä¿æŒå’ŒæœåŠ¡ç«¯ä¸€è‡´ã€‚å½“ç„¶ä½ å¯ä»¥è‡ªå·±ç”Ÿæˆæ‰€éœ€è¦çš„ UUIDï¼Œåˆ°è¿™ä¸ªç½‘ç«™  <a href="https://www.uuidgenerator.net/" target="_blank" rel="noopener">Online UUID Generator </a> ç”Ÿæˆå°±å¯ä»¥äº†ã€‚</p><p>æ‰§è¡Œ <code>systemctl start v2ray</code> ç„¶åæ‰§è¡Œ <code>systemctl status v2ray</code> ä¹‹åï¼Œå¦‚æœçœ‹åˆ°ç»¿è‰²çš„ <code>active(running)</code>  å°±è¯´æ˜å¯åŠ¨æˆåŠŸäº†ï¼Œè¿™é‡Œå°±å…ˆå°†æ‰€æœ‰æœåŠ¡å…ˆå®‰è£…å¥½ï¼Œé…ç½®åœ¨æœ€åä¸€å—é…ç½®å°±è¡Œäº†ã€‚</p><h4 id="å®‰è£…-nginx"><a href="#å®‰è£…-nginx" class="headerlink" title="å®‰è£… nginx"></a>å®‰è£… nginx</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ automake pcre pcre-devel zlib zlib-devel open openssl-devel</span><br><span class="line"></span><br><span class="line">wget http://nginx.org/download/nginx-1.14.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar zxvf nginx-1.14.1.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> nginx-1.14.1</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/<span class="built_in">log</span>/nginx/error.log --http-log-path=/var/<span class="built_in">log</span>/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --user=nginx --group=nginx --with-http_ssl_module --with-http_v2_module --with-http_dav_module --with-http_stub_status_module --with-threads --with-file-aio</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>äº”éƒ¨ Nginx å°±å®‰è£…å¥½äº†ã€‚æœ€ååŠ ä¸€ä¸‹è½¯è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/<span class="built_in">local</span>/nginx/sbin/nginx /usr/bin/</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…è¯ä¹¦"><a href="#å®‰è£…è¯ä¹¦" class="headerlink" title="å®‰è£…è¯ä¹¦"></a>å®‰è£…è¯ä¹¦</h3><p>è¿™é‡Œå‡è®¾ä½ å·²ç»æ‹¥æœ‰äº†åŸŸåï¼Œå¹¶ä¸”å¢åŠ äº† A è§£æåˆ°è¯¥å° VPSã€‚ä¸‹é¢æˆ‘ä»¬ç”³è¯·è¯ä¹¦ï¼Œè¯ä¹¦è¿‡ç¨‹ä¹Ÿå¾ˆç®€å•ã€‚å®‰è£…ä¸¤ä¸ªè„šæœ¬ä¾¿å¯ä»¥äº†ã€‚è¿™é‡Œåˆ©ç”¨ Certbot æ¥ç”³è¯·ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release</span><br><span class="line">yum install -y certbot</span><br><span class="line">curl  https://get.acme.sh | sh</span><br></pre></td></tr></table></figure><p>å®‰è£æˆåŠŸåæ‰§è¡Œ <code>source ~/.bashrc</code> ä»¥ç¡®ä¿è„šæœ¬æ‰€è®¾ç½®çš„å‘½ä»¤åˆ¥åç”Ÿæ•ˆã€‚<br>å¦‚æœå®‰è£…æŠ¥é”™ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯å› ä¸ºç³»ç»Ÿç¼ºå°‘ <code>acme.sh</code> æ‰€éœ€è¦çš„ä¾èµ–é¡¹, <code>acme.sh</code> çš„ä¾èµ–é¡¹ä¸»è¦æ˜¯ <code>netcat(nc)</code>, æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…è¿™äº›ä¾èµ–ï¼Œç„¶åé‡æ–°å®‰è£…ä¸€é</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install netcat</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆè¯ä¹¦ä¹‹å‰ï¼Œè¯·ç¡®ä¿å®¿ä¸»æœºä¸Šçš„ 80 ç«¯å£æ²¡æœ‰è¢«å ç”¨ï¼Œå¦åˆ™ä¼šå®‰è£…å¤±è´¥</p><blockquote><p>~/.acme.sh/acme.sh â€“issue -d mydomain.me â€“standalone -k ec-256</p></blockquote><p><code>-k</code> è¡¨ç¤ºç§˜é’¥é•¿åº¦ï¼Œåé¢çš„å€¼å¯ä»¥æ˜¯ <code>ec-256</code> ã€<code>ec-384</code>ã€2048ã€3072ã€4096ã€8192ï¼Œå¸¦æœ‰ <code>ec</code> è¡¨ç¤ºç”Ÿæˆçš„æ˜¯ <code>ECC</code> è¯ä¹¦ï¼Œæ²’æœ‰åˆ™æ˜¯ <code>RSA</code> è¯ä¹¦ã€‚åœ¨å®‰å…¨æ€§ä¸Š 256 ä½çš„ <code>ECC</code> è¯ä¹¦ç­‰åŒäº 3072 ä½çš„ <code>RSA</code> è¯ä¹¦ã€‚</p><p>Letâ€™s Encrypt çš„è¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰ 3 å€‹æœˆï¼Œå› æ­¤éœ€è¦ 90 å¤©è‡³å°‘è¦æ›´æ–°ä¸€æ¬¡è¯ä¹¦ï¼Œacme.shè„šæœ¬ä¼šæ¯ 60 å¤©è‡ªåŠ¨æ›´æ–°è¯ä¹¦ï¼Œã€‚ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ›´æ–°ã€‚</p><p>æ‰‹åŠ¨æ›´æ–° ECC è¯ä¹¦ï¼Œæ‰§è¡Œï¼š</p><blockquote><p>sudo ~/.acme.sh/acme.sh â€“renew -d mydomain.com â€“force â€“ecc</p></blockquote><p>å¦‚æœæ˜¯ RSA è¯ä¹¦åˆ™æ‰§è¡Œï¼š</p><blockquote><p>sudo ~/.acme.sh/acme.sh â€“renew -d mydomain.com â€“force</p></blockquote><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="v2rayæœåŠ¡ç«¯é…ç½®"><a href="#v2rayæœåŠ¡ç«¯é…ç½®" class="headerlink" title="v2rayæœåŠ¡ç«¯é…ç½®"></a>v2rayæœåŠ¡ç«¯é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"log"</span>: &#123;</span><br><span class="line">    <span class="string">"access"</span>: <span class="string">"/var/log/v2ray/access.log"</span>,</span><br><span class="line">    <span class="string">"error"</span>: <span class="string">"/var/log/v2ray/error.log"</span>,</span><br><span class="line">    <span class="string">"loglevel"</span>: <span class="string">"debug"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"inbound"</span>: &#123;</span><br><span class="line">    <span class="string">"listen"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="string">"port"</span>: ***, // ä½ çš„å®é™…ç«¯å£å·</span><br><span class="line">    <span class="string">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="string">"settings"</span>: &#123;</span><br><span class="line">      <span class="string">"clients"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"id"</span>: <span class="comment">### uuid,</span></span><br><span class="line">          <span class="string">"alterId"</span>: 64,</span><br><span class="line">          <span class="string">"level"</span>: 1</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="string">"network"</span>: <span class="string">"ws"</span>,</span><br><span class="line">      <span class="string">"security"</span>: <span class="string">"auto"</span>,</span><br><span class="line">      <span class="string">"wsSettings"</span>: &#123;</span><br><span class="line">        <span class="string">"path"</span>: <span class="string">"path"</span>, // è‡ªå®šä¹‰</span><br><span class="line">        <span class="string">"headers"</span>: &#123;</span><br><span class="line">          <span class="string">"Host"</span>: <span class="string">"yourDomain"</span> // ä½ çš„åŸŸååœ°å€</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"outbound"</span>: &#123;</span><br><span class="line">    <span class="string">"protocol"</span>: <span class="string">"freedom"</span>,</span><br><span class="line">    <span class="string">"settings"</span>: &#123; &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"outboundDetour"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"protocol"</span>: <span class="string">"blackhole"</span>,</span><br><span class="line">      <span class="string">"settings"</span>: &#123; &#125;,</span><br><span class="line">      <span class="string">"tag"</span>: <span class="string">"blocked"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"routing"</span>: &#123;</span><br><span class="line">    <span class="string">"strategy"</span>: <span class="string">"rules"</span>,</span><br><span class="line">    <span class="string">"settings"</span>: &#123;</span><br><span class="line">      <span class="string">"rules"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"field"</span>,</span><br><span class="line">          <span class="string">"ip"</span>: [</span><br><span class="line">            <span class="string">"0.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"10.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"100.64.0.0/10"</span>,</span><br><span class="line">            <span class="string">"127.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"169.254.0.0/16"</span>,</span><br><span class="line">            <span class="string">"172.16.0.0/12"</span>,</span><br><span class="line">            <span class="string">"192.0.0.0/24"</span>,</span><br><span class="line"><span class="string">"192.0.2.0/24"</span>,</span><br><span class="line">            <span class="string">"192.168.0.0/16"</span>,</span><br><span class="line">            <span class="string">"198.18.0.0/15"</span>,</span><br><span class="line">            <span class="string">"198.51.100.0/24"</span>,</span><br><span class="line">            <span class="string">"203.0.113.0/24"</span>,</span><br><span class="line">            <span class="string">"::1/128"</span>,</span><br><span class="line">            <span class="string">"fc00::/7"</span>,</span><br><span class="line">            <span class="string">"fe80::/10"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="string">"outboundTag"</span>: <span class="string">"blocked"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="nginx-é…ç½®"><a href="#nginx-é…ç½®" class="headerlink" title="nginx é…ç½®"></a>nginx é…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        <span class="comment"># ç¦ç”¨ä¸éœ€è¦çš„è¯·æ±‚æ–¹å¼ ä»¥ä¸‹åªå…è®¸ getã€post</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$request_method</span>  !~ ^(POST|GET)$) &#123;</span><br><span class="line">                <span class="built_in">return</span>  444;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        listen          80;</span><br><span class="line">        server_name     yourDomain;        <span class="comment">#æ³¨ï¼šå¡«å†™è‡ªå·±çš„åŸŸå</span></span><br><span class="line">        <span class="built_in">return</span>          301  yourDomain;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">upstream v2ray &#123;</span><br><span class="line">        server          127.0.0.1:ç«¯å£;        <span class="comment">#æ³¨ï¼šv2rayåç«¯ç›‘å¬åœ°å€ã€ç«¯å£</span></span><br><span class="line">        keepalive       2176;   <span class="comment"># é“¾æ¥æ± ç©ºé—²é“¾æ¥æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">map <span class="variable">$http_upgrade</span> <span class="variable">$connection_upgrade</span> &#123;</span><br><span class="line">        default         upgrade;</span><br><span class="line">        <span class="string">''</span>              close;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        <span class="comment">#è¦å¼€å¯ HTTP/2 æ³¨æ„nginxç‰ˆæœ¬</span></span><br><span class="line">        <span class="comment">#å¯ä»¥ä½¿ç”¨ nginx -V æ£€æŸ¥</span></span><br><span class="line">        listen  443 ssl http2 backlog=1024 so_keepalive=120s:60s:10 reuseport;  <span class="comment"># backlogæ˜¯nginx ç›‘å¬é˜Ÿåˆ— é»˜è®¤æ˜¯511 ä½¿ç”¨å‘½ä»¤ ss -tnlæŸ¥çœ‹(Send-Q);</span></span><br><span class="line">        <span class="comment">#è®¾ç½®ç¼–ç </span></span><br><span class="line">        charset         utf-8;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#è¯ä¹¦é…ç½®</span></span><br><span class="line">        ssl_certificate         path;   <span class="comment">#æ³¨ï¼šå¡«å†™è‡ªå·±è¯ä¹¦è·¯å¾„</span></span><br><span class="line">        ssl_certificate_key    path;   <span class="comment">#æ³¨ï¼šå¡«å†™å¯†é’¥è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">        ssl_session_cache       shared:SSL:50m;</span><br><span class="line">        ssl_session_timeout     1d;</span><br><span class="line">        ssl_session_tickets     off;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># https://nginx.org/en/docs/http/ngx_http_ssl_module.html</span></span><br><span class="line">        ssl_protocols   TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        <span class="comment">#openssl ciphers</span></span><br><span class="line">        <span class="comment">#æ³¨ï¼šæ‡’äººé…ç½®   https://mozilla.github.io/server-side-tls/ssl-config-generator/</span></span><br><span class="line">        ssl_ciphers     HIGH:!aNULL:!MD5;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#å®‰å…¨è®¾å®š</span></span><br><span class="line">        <span class="comment">#å±è”½è¯·æ±‚ç±»å‹</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$request_method</span>  !~ ^(POST|GET)$) &#123;</span><br><span class="line">                <span class="built_in">return</span>  444;</span><br><span class="line">        &#125;</span><br><span class="line">        add_header      X-Frame-Options         DENY;</span><br><span class="line">        add_header      X-XSS-Protection        <span class="string">"1; mode=block"</span>;</span><br><span class="line">        add_header      X-Content-Type-Options  nosniff;</span><br><span class="line">        add_header      Strict-Transport-Security max-age=15 always;</span><br><span class="line">        root    /var/www/html;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Add index.php to the list if you are using PHP</span></span><br><span class="line">        index index.html index.htm  index.php ;</span><br><span class="line"></span><br><span class="line">        server_name     yourDomain;        <span class="comment">#æ³¨ï¼š å°†domain.Name æ›¿æ¢æˆä½ çš„åŸŸå</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location /path &#123; <span class="comment">#æ³¨ï¼šä¿®æ”¹è·¯å¾„ï¼Œä¸Šè¿°æœåŠ¡ç«¯ ws é…ç½®çš„ path</span></span><br><span class="line">                proxy_http_version      1.1;</span><br><span class="line">                proxy_set_header        Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">                proxy_set_header        Connection <span class="string">"upgrade"</span>;   <span class="comment">#æ­¤å¤„ä¸&lt;map&gt;å¯¹åº”</span></span><br><span class="line">proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">                sendfile                on;</span><br><span class="line">                tcp_nopush              on;</span><br><span class="line">                tcp_nodelay             on;</span><br><span class="line">                keepalive_requests      25600;</span><br><span class="line">                keepalive_timeout       300 300;</span><br><span class="line">                proxy_buffering         off;</span><br><span class="line">                proxy_buffer_size       8k;</span><br><span class="line"></span><br><span class="line">                <span class="comment">#åç«¯é”™è¯¯é‡å®šå‘</span></span><br><span class="line">                proxy_intercept_errors on;</span><br><span class="line">                error_page 400 = <span class="string">"yourDomain"</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$http_host</span> = <span class="string">"yourDomain"</span> ) &#123;</span><br><span class="line">                        proxy_pass      http://127.0.0.1:ç«¯å£; // è®¾ç½® v2ray ç›‘å¬çš„åœ°å€</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æ¨èä½¿ç”¨ <code>v2rayN</code>,  è¿™æ˜¯ä¸€æ¬¾ window ç•Œé¢çš„äº§å“ï¼Œé…ç½®å¾ˆç®€å•ã€‚<br><img data-src="https://ws1.sinaimg.cn/large/7512bce3ly1fpzfy0vdavj20kc0e9weq.jpg" alt=""></p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><ul><li><code>v2rayN</code> è¿™æ¬¾å®¢æˆ·ç«¯æ— æ³•ä»£ç† <strong>go get</strong>ï¼ŒåŸå› ä¸è¯¦ï¼Œ<code>wireshark</code> æ— æ³•æŠ“åˆ°åŒ…ï¼Œæœ¬èº«çš„ <code>shadowsocks</code> å®¢æˆ·ç«¯æ­£å¸¸</li><li>æ·»åŠ  shadowsocks æœåŠ¡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"inboundDetour"</span>: [</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="string">"protocol"</span>: <span class="string">"shadowsocks"</span>,</span><br><span class="line">     <span class="string">"port"</span>: 10086, // è‡ªè¡Œè®¾ç½®</span><br><span class="line">     <span class="string">"settings"</span>: &#123;</span><br><span class="line">      <span class="string">"method"</span>: <span class="string">"aes-256-cfb"</span>, // å’Œå®¢æˆ·ç«¯è®¾ç½®çš„åŠ å¯†æ–¹å¼ä¸€æ ·ï¼Œè‡ªè¡Œè®¾ç½®</span><br><span class="line">      <span class="string">"password"</span>: <span class="string">"****"</span>, // å¯†ç è®¾ç½®</span><br><span class="line">      <span class="string">"udp"</span>: <span class="literal">false</span></span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br></pre></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä»¥ä¸Šä¾¿æ˜¯å®‰è£…çš„å…¨éƒ¨è¿‡ç¨‹ï¼Œå¯èƒ½è¿‡ç¨‹æœ‰ç–æ¼ï¼Œä¹Ÿå¯èƒ½ä½ åœ¨é…ç½®çš„è¿‡ç¨‹ä¸­æœ€åè®¿é—®ä¸äº†ï¼Œé—®é¢˜æœ‰å¾ˆå¤šï¼Œå¯èƒ½æ˜¯ç‰ˆæœ¬ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜ã€‚é‡åˆ°é—®é¢˜è¯·è‡ªè¡Œ googleã€‚<br>è¿˜æœ‰åƒä¸‡ä¸è¦ <em>ç²˜è´´å¤åˆ¶ ç²˜è´´å¤åˆ¶ ç²˜è´´å¤åˆ¶</em></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ä»£ç†&quot;&gt;&lt;a href=&quot;#ä»£ç†&quot; class=&quot;headerlink&quot; title=&quot;ä»£ç†&quot;&gt;&lt;/a&gt;ä»£ç†&lt;/h3&gt;&lt;p&gt; ç”±äºæœ€è¿‘ä½¿ç”¨ vps è¿ç»­è¢«å°ç¦ï¼Œä¸çŸ¥æ˜¯å¦æ˜¯å› ä¸ºåˆ‡æ¢åˆ° SSR çš„ç¼˜æ•…ï¼Ÿæˆ‘ä»ç½‘ç»œä¸Šçœ‹åˆ°å¾ˆå¤šå…³äº SSR è¢«å°ç¦çš„æƒ…å†µï¼Œå¥½åƒæ˜¯ç”±äºå¢™ä¸éœ€è¦å»
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="v2ray" scheme="https://njphper.com/tags/v2ray/"/>
    
  </entry>
  
  <entry>
    <title>Lumen è·¨åŸŸé—®é¢˜è§£å†³</title>
    <link href="https://njphper.com/posts/lumen-cros/"/>
    <id>https://njphper.com/posts/lumen-cros/</id>
    <published>2018-11-23T22:46:53.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è·¨åŸŸ"><a href="#è·¨åŸŸ" class="headerlink" title="è·¨åŸŸ"></a>è·¨åŸŸ</h2><blockquote><p>ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿä¸ºä½•ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Ÿ</p></blockquote><p>é¦–å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆå«åšåŸŸï¼Ÿç®€å•çš„å®šä¹‰å°±æ˜¯ <strong>åè®®ã€åŸŸåã€ç«¯å£éƒ½ç›¸åŒå«åšåŸŸ</strong>ï¼Œç¼ºä¸€ä¸å¯ï¼Œè¿˜æœ‰è¿™é‡Œçš„åŸŸå¹¶ä¸æ˜¯å•æŒ‡åŸŸåã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨è§„å®šäº†ä¸€ç§<code>åŒæºç­–ç•¥</code>ã€‚è¿™é‡Œçš„æºå¯ä»¥ç†è§£ä¸ºåŸŸã€‚<br><strong>åŒæºç­–ç•¥</strong> çš„äº§ç”Ÿæ˜¯å¤„äºå®‰å…¨è€ƒè™‘çš„ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä»¥ <code>Http</code> åè®®ä¸ºä¾‹ï¼Œ<code>Http</code> åè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ºäº†ä¿ç•™æŸäº›ç”¨æˆ·çš„ä¿¡æ¯é‡‡ç”¨äº† <code>Cookie</code> æ–¹æ³•ï¼Œç°åœ¨çš„ <code>H5</code> è¿˜æœ‰ <code>LocalStorage</code> ã€‚è®¾æƒ³ä¸€ä¸‹å¦‚æœä½ ç™»å½•äº†æˆ‘çš„åšå®¢ï¼Œå¿…ç„¶ä¼šåœ¨å¤´éƒ¨ä¿¡æ¯ä¸­å¸¦æœ‰ç™»å½• <code>Cookie</code> ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰åŒæºç­–ç•¥çš„è¯ï¼Œä½ è®¿é—®å…¶ä»–å…¶ä»–ç½‘ç«™çš„æ—¶å€™å°±ä¼šå¸¦ä¸Š <code>cookie</code> ä¿¡æ¯ï¼Œè®¿é—®å¯¹æ–¹æ˜¯æ¶æ„ç½‘ç«™çš„è¯ï¼Œè¯¥æ¶æ„ç½‘ç«™å¯ä»¥é€šè¿‡è®¿é—®æˆ‘åšå®¢çš„æ¥å£å®Œå…¨è·å–ä½ çš„ ä¸ªäººä¿¡æ¯æˆ–è€…ä¿®æ”¹ä½ çš„ä¿¡æ¯ã€‚</p><p>   ç°å®ä¸­è¿˜æ˜¯éœ€è¦çªç ´è¿™ä¸ªç­–ç•¥éœ€æ±‚çš„ï¼Œæ‰€ä»¥ <code>W3C</code> åˆ¶å®šäº† <code>CORS</code> æ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ï¼ˆ<code>Cross-origin resource sharing</code>ï¼‰ã€‚</p><h3 id="è·¨åŸŸè¯·æ±‚å…±äº«"><a href="#è·¨åŸŸè¯·æ±‚å…±äº«" class="headerlink" title="è·¨åŸŸè¯·æ±‚å…±äº«"></a>è·¨åŸŸè¯·æ±‚å…±äº«</h3><p>ç›®å‰ä¸»æµæµè§ˆå™¨éƒ½æ˜¯æ”¯æŒ <code>CORS</code> æ ‡å‡†çš„ï¼Œæ‰€ä»¥å½“ä½ è¿›è¡Œè·¨åŸŸè¯·æ±‚çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®Œæˆæ•´ä¸ªè¿‡ç¨‹ã€‚ä½†æ˜¯æœåŠ¡å™¨ç«¯å¹¶ä¸ä¼šï¼Œæ‰€ä»¥éœ€è¦çš„è§£å†³çš„å°±æ˜¯æœåŠ¡å™¨ç«¯çš„é—®é¢˜ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹æ³¨æ„çš„å°±æ˜¯æµè§ˆå™¨ä¼šå¤šå‘å‡ºä¸€æ¬¡ <code>OPTIONS</code> è¯·æ±‚ï¼Œè¿™ä¸ªç§°ä½œé¢„æ£€ï¼Œç”¨ä»¥åˆ¤æ–­å®é™…å‘é€çš„è¯·æ±‚æ˜¯å¦å®‰å…¨ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸éœ€è¦ç†ä¼šçš„ã€‚</p><h4 id="ä¸¤ç§è¯·æ±‚"><a href="#ä¸¤ç§è¯·æ±‚" class="headerlink" title="ä¸¤ç§è¯·æ±‚"></a>ä¸¤ç§è¯·æ±‚</h4><h5 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ï¼š</span><br><span class="line">  1. get</span><br><span class="line">  2. post</span><br><span class="line">  3. head</span><br><span class="line">2. HTTP çš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µï¼š</span><br><span class="line">1. Accept</span><br><span class="line">2. Accept-Language</span><br><span class="line">3. Content-Language</span><br><span class="line">4. Last-Event-ID</span><br><span class="line">5. Content-Typeï¼šåªé™äºä¸‰ä¸ªå€¼application&#x2F;x-www-form-urlencodedã€multipart&#x2F;form-dataã€text&#x2F;plain</span><br></pre></td></tr></table></figure><p>æ»¡è¶³ä»¥ä¸Šä¸¤ç§æ¡ä»¶çš„éƒ½ç§°ä¹‹ä¸ºç®€å•è¯·æ±‚ï¼Œå…¶ä»–çš„åˆ™æ˜¯éç®€å•è¯·æ±‚ã€‚æµè§ˆå™¨å¯¹äºè¿™ç§è¯·æ±‚çš„å¤„ç†æ–¹å¼ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h4 id="ç®€å•è¯·æ±‚å“åº”"><a href="#ç®€å•è¯·æ±‚å“åº”" class="headerlink" title="ç®€å•è¯·æ±‚å“åº”"></a>ç®€å•è¯·æ±‚å“åº”</h4><p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨å‘å‡ºè·¨åŸŸè¯·æ±‚çš„æ—¶å€™ï¼Œåªä¼šç®€å•çš„åœ¨å¤´éƒ¨åŠ ä¸Š <code>Origin</code> å­—æ®µï¼Œåœ¨ <code>Origin</code> æŒ‡å®šçš„åŸŸåæœåŠ¡å™¨å“åº”ä¸­ï¼Œå½“ç„¶æ˜¯å…è®¸è·¨åŸŸçš„æœåŠ¡å™¨ï¼Œä¼šå¤šå‡ºå‡ ä¸ªå“åº”å­—æ®µï¼Œéƒ½æ˜¯ä»¥ <code>Access-Control-</code> å¼€å¤´çš„å­—æ®µã€‚</p><h5 id="Access-Control-Allow-Origin"><a href="#Access-Control-Allow-Origin" class="headerlink" title="Access-Control-Allow-Origin"></a>Access-Control-Allow-Origin</h5><p>è¯¥å­—æ®µæ˜¯<code>å¿…é¡»</code>çš„ã€‚å®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶ <code>Origin</code> å­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª <code>*</code>ï¼Œè¡¨ç¤ºæ¥å—ä»»æ„åŸŸåçš„è¯·æ±‚ã€‚</p><h5 id="Access-Control-Allow-Credentials"><a href="#Access-Control-Allow-Credentials" class="headerlink" title="Access-Control-Allow-Credentials"></a>Access-Control-Allow-Credentials</h5><p>è¯¥å­—æ®µ<code>å¯é€‰</code>ã€‚å®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€ <code>Cookie</code> ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Cookie</code> ä¸åŒ…æ‹¬åœ¨ <code>CORS</code> è¯·æ±‚ä¹‹ä¸­ã€‚è®¾ä¸º <code>true</code>ï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨æ˜ç¡®è®¸å¯ï¼Œ<code>Cookie</code> å¯ä»¥åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ã€‚è¿™ä¸ªå€¼ä¹Ÿåªèƒ½è®¾ä¸º <code>true</code>ï¼Œå¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€ <code>Cookie</code>ï¼Œåˆ é™¤è¯¥å­—æ®µå³å¯ã€‚</p><h5 id="Access-Control-Expose-Headers"><a href="#Access-Control-Expose-Headers" class="headerlink" title="Access-Control-Expose-Headers"></a>Access-Control-Expose-Headers</h5><p>è¯¥å­—æ®µ<code>å¯é€‰</code>ã€‚<code>CORS</code> è¯·æ±‚æ—¶ï¼Œ<code>XMLHttpRequest</code> å¯¹è±¡çš„ <code>getResponseHeader()</code> æ–¹æ³•åªèƒ½æ‹¿åˆ°6ä¸ªåŸºæœ¬å­—æ®µï¼š<code>Cache-Controlã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragma</code>ã€‚å¦‚æœæƒ³æ‹¿åˆ°å…¶ä»–å­—æ®µï¼Œå°±å¿…é¡»åœ¨ <code>Access-Control-Expose-Headers</code> é‡Œé¢æŒ‡å®šã€‚</p><h4 id="éç®€å•è¯·æ±‚"><a href="#éç®€å•è¯·æ±‚" class="headerlink" title="éç®€å•è¯·æ±‚"></a>éç®€å•è¯·æ±‚</h4><p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯ <code>PUT</code> æˆ– <code>DELETE</code>ï¼Œæˆ–è€… <code>Content-Type</code> å­—æ®µçš„ç±»å‹æ˜¯<code>application/json</code>ã€‚<br>é™¤äº†ç®€å•è¯·æ±‚çš„ <code>Origin</code> å­—æ®µå¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„å¤´ä¿¡æ¯å­—æ®µ:</p><h5 id="Access-Control-Request-Method"><a href="#Access-Control-Request-Method" class="headerlink" title="Access-Control-Request-Method"></a>Access-Control-Request-Method</h5><p>è¯¥å­—æ®µæ˜¯<code>å¿…é¡»</code>çš„ï¼Œç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„ <code>CORS</code> è¯·æ±‚ä¼šç”¨åˆ°å“ªäº› <code>HTTP</code> æ–¹æ³•ï¼Œä¸Šä¾‹æ˜¯ <code>PUT</code>ã€‚</p><h5 id="Access-Control-Request-Headers"><a href="#Access-Control-Request-Headers" class="headerlink" title="Access-Control-Request-Headers"></a>Access-Control-Request-Headers</h5><p>è¯¥å­—æ®µæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæµè§ˆå™¨ <code>CORS</code> è¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µã€‚</p><h4 id="éç®€å•è¯·æ±‚å“åº”"><a href="#éç®€å•è¯·æ±‚å“åº”" class="headerlink" title="éç®€å•è¯·æ±‚å“åº”"></a>éç®€å•è¯·æ±‚å“åº”</h4><p>å½“æœåŠ¡å™¨å‘å‡ºéç®€å•è¯·æ±‚çš„æ—¶å€™ï¼ŒæœåŠ¡æ®µä¼šå“åº”ä¸€ä¸‹å‡ ä¸ªå¤´ä¿¡æ¯:</p><h5 id="Access-Control-Allow-Methods"><a href="#Access-Control-Allow-Methods" class="headerlink" title="Access-Control-Allow-Methods"></a>Access-Control-Allow-Methods</h5><p>è¯¥å­—æ®µ<code>å¿…éœ€</code>ï¼Œå®ƒçš„å€¼æ˜¯é€—å·åˆ†éš”çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰æ”¯æŒçš„æ–¹æ³•ï¼Œè€Œä¸å•æ˜¯æµè§ˆå™¨è¯·æ±‚çš„é‚£ä¸ªæ–¹æ³•ã€‚è¿™æ˜¯ä¸ºäº†é¿å…å¤šæ¬¡â€é¢„æ£€â€è¯·æ±‚ã€‚</p><h5 id="Access-Control-Allow-Headers"><a href="#Access-Control-Allow-Headers" class="headerlink" title="Access-Control-Allow-Headers"></a>Access-Control-Allow-Headers</h5><p>å¦‚æœæµè§ˆå™¨è¯·æ±‚åŒ…æ‹¬ <code>Access-Control-Request-Headers</code> å­—æ®µï¼Œåˆ™ <code>Access-Control-Allow-Headers</code> å­—æ®µæ˜¯<code>å¿…éœ€</code>çš„ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰å¤´ä¿¡æ¯å­—æ®µï¼Œä¸é™äºæµè§ˆå™¨åœ¨â€é¢„æ£€â€ä¸­è¯·æ±‚çš„å­—æ®µã€‚</p><h5 id="Access-Control-Allow-Credentials-1"><a href="#Access-Control-Allow-Credentials-1" class="headerlink" title="Access-Control-Allow-Credentials"></a>Access-Control-Allow-Credentials</h5><p>è¯¥å­—æ®µä¸ç®€å•è¯·æ±‚æ—¶çš„å«ä¹‰ç›¸åŒã€‚</p><h5 id="Access-Control-Max-Age"><a href="#Access-Control-Max-Age" class="headerlink" title="Access-Control-Max-Age"></a>Access-Control-Max-Age</h5><p>è¯¥å­—æ®µ<code>å¯é€‰</code>ï¼Œç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ã€‚ä¸Šé¢ç»“æœä¸­ï¼Œæœ‰æ•ˆæœŸæ˜¯20å¤©ï¼ˆ1728000ç§’ï¼‰ï¼Œå³å…è®¸ç¼“å­˜è¯¥æ¡å›åº”1728000ç§’ï¼ˆå³20å¤©ï¼‰ï¼Œåœ¨æ­¤æœŸé—´ï¼Œä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚ã€‚</p><h4 id="Lumen-å¤„ç†è·¨åŸŸè¯·æ±‚"><a href="#Lumen-å¤„ç†è·¨åŸŸè¯·æ±‚" class="headerlink" title="Lumen å¤„ç†è·¨åŸŸè¯·æ±‚"></a>Lumen å¤„ç†è·¨åŸŸè¯·æ±‚</h4><p>å›åˆ°æ ‡é¢˜çš„é—®é¢˜ï¼Œå¦‚æœæ¥è§£å†³ <code>Lumen</code>  çš„è·¨åŸŸè¯·æ±‚é—®é¢˜ã€‚äº†è§£ <code>CORS</code> æ ‡å‡†ä¹‹åï¼Œå¦‚æœä½ ä½¿ç”¨ <code>Lumen</code> æ¡†æ¶æ˜¯åŸºäº <code>restful api</code> çš„è¯ï¼Œå°±é¿å…ä¸äº† <code>PUT</code> å’Œ <code>DELETE</code> è¯·æ±‚ã€‚<br>éœ€è¦å»ºç«‹ä¸€ä¸‹å‡ ä¸ªå“åº”å­—æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: &#39;*&#39; &#x2F;&#x2F; å…è®¸çš„åŸŸå</span><br><span class="line">Access-Control-Allow-Methods: &#39;*&#39; &#x2F;&#x2F; å…è®¸çš„æ–¹æ³•</span><br><span class="line">Access-Control-Allow-Headers: &#39;Content-Type, Authorization, X-Requested-With&#39;</span><br><span class="line">Access-Control-Max-Age: &#39;&#39; &#x2F;&#x2F; å¦‚æœä½ ä¸éœ€è¦æ¯æ¬¡éƒ½è¦é¢„è¯·æ±‚çš„è¯å¯ä»¥æ·»åŠ è¯¥å­—æ®µ</span><br></pre></td></tr></table></figure><p>å»ºç«‹ä¸€ä¸ª <code>CORS</code> ä¸­é—´ä»¶æ–‡ä»¶:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">namespace App\Http\Middleware;</span><br><span class="line"></span><br><span class="line">use Closure;</span><br><span class="line"></span><br><span class="line">class CorsMiddleware</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * Handle an incoming request.</span><br><span class="line">     *</span><br><span class="line">     * @param  \Illuminate\Http\Request  $request</span><br><span class="line">     * @param  \Closure  $next</span><br><span class="line">     * @return mixed</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public function handle($request, Closure $next)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $response &#x3D; $next($request);</span><br><span class="line">        $response-&gt;header(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);</span><br><span class="line">        $response-&gt;header(&#39;Access-Control-Allow-Methods&#39;, &#39;*&#39;);</span><br><span class="line">        $response-&gt;header(&#39;Access-Control-Allow-Headers&#39;, &#39;Content-Type, Authorization, X-Requested-With&#39;);</span><br><span class="line">        return $response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>boostrap\app.php</code> æ–‡ä»¶åŠ å…¥ä¸­é—´ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    $app-&gt;middleware([</span><br><span class="line">    App\Http\Middleware\CorsMiddleware::class,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥è§£å†³è·¨åŸŸé—®é¢˜äº†</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;è·¨åŸŸ&quot;&gt;&lt;a href=&quot;#è·¨åŸŸ&quot; class=&quot;headerlink&quot; title=&quot;è·¨åŸŸ&quot;&gt;&lt;/a&gt;è·¨åŸŸ&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿä¸ºä½•ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¦–å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆå«åšåŸŸï¼Ÿç®€å•çš„å®šä¹‰å°±æ˜¯
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://njphper.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="lumen" scheme="https://njphper.com/tags/lumen/"/>
    
      <category term="è·¨åŸŸ" scheme="https://njphper.com/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>Lumen ä½¿ç”¨ Jwt è¿‡ç¨‹è®°å½•</title>
    <link href="https://njphper.com/posts/lumen-jwt/"/>
    <id>https://njphper.com/posts/lumen-jwt/</id>
    <published>2018-11-20T22:58:24.000Z</published>
    <updated>2019-05-19T10:19:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æƒ³æä¸€ä¸‹å‰åç«¯åˆ†ç¦»ï¼Œæ‰€ä»¥å°±åŸºäº Vue æƒ³åšä¸€ä¸‹åŸºç¡€çš„åå°ç®¡ç†ï¼Œåç«¯å°±é€‰ç”¨äº† Lumen5.7.*ï¼Œå› ä¸ºè§£å†³æ–¹æ¡ˆå¤šï¼Œæ–¹ä¾¿ã€‚è®¤è¯å°±åœ¨æ­¤åŸºç¡€ä½¿ç”¨äº† Json Web Token(JWT)ã€‚è¿™é‡Œè®°å½•ä¸€äº›ä½¿ç”¨è¿‡ç¨‹ã€‚</p><h3 id="ä¸‹è½½-Jwt-åŒ…"><a href="#ä¸‹è½½-Jwt-åŒ…" class="headerlink" title="ä¸‹è½½ Jwt åŒ…"></a>ä¸‹è½½ Jwt åŒ…</h3><p>ä¿®æ”¹ <code>composer.json</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"require"</span>: &#123;</span><br><span class="line">        <span class="string">"tymon/jwt-auth"</span>: <span class="string">"1.0.*"</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><blockquote><p>composer update</p></blockquote><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>ä¿®æ”¹ <code>bootstrap</code>  ç›®å½•ä¸‹ <code>app.php</code> æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> $app-&gt;withFacades();</span><br><span class="line"></span><br><span class="line"> $app-&gt;withEloquent();</span><br><span class="line"></span><br><span class="line">$app-&gt;routeMiddleware([</span><br><span class="line">     <span class="string">'auth'</span> =&gt; App\Http\Middleware\Authenticate::class,</span><br><span class="line"> ]);</span><br><span class="line"> $app-&gt;register(App\Providers\AppServiceProvider::class);</span><br><span class="line"> $app-&gt;register(App\Providers\AuthServiceProvider::class);</span><br></pre></td></tr></table></figure><p>æ‰“å¼€è¿™äº”è¡Œæ³¨é‡Šã€‚ç„¶åè¿›å…¥åˆ° AppServiceProvider æœåŠ¡æ³¨å…¥æ–‡ä»¶, æ³¨å†Œ Jwt æœåŠ¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Register Jwt Service</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;app-&gt;register(\Tymon\JWTAuth\Providers\LumenServiceProvider::class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡éœ€è¦å¢åŠ  Jwt Auth è®¤è¯é…ç½®ã€‚æ‰€ä»¥åœ¨æ ¹ç›®å½•ä¸‹å¢åŠ é…ç½®æ–‡ä»¶ç›®å½• <code>config</code>ï¼Œç„¶åå¢åŠ  <code>auth.php</code> é…ç½®æ–‡ä»¶ï¼Œå†…å®¹ä» <code>laravel\lumen-framework\config\auth.php</code> å¤åˆ¶è¿‡æ¥ã€‚é…ç½®å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> [</span><br><span class="line"></span><br><span class="line">    <span class="string">'defaults'</span> =&gt; [</span><br><span class="line">        <span class="string">'guard'</span> =&gt; env(<span class="string">'AUTH_GUARD'</span>, <span class="string">'api'</span>),</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="string">'guards'</span> =&gt; [</span><br><span class="line">        <span class="string">'api'</span> =&gt; [</span><br><span class="line">            <span class="string">'driver'</span> =&gt; <span class="string">'jwt'</span>,</span><br><span class="line">            <span class="string">'provider'</span> =&gt; <span class="string">'users'</span>,</span><br><span class="line">    ],</span><br><span class="line">   ],</span><br><span class="line"></span><br><span class="line">   <span class="string">'providers'</span> =&gt; [</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="string">'users'</span> =&gt; [</span><br><span class="line">        <span class="string">'driver'</span> =&gt; <span class="string">'eloquent'</span>,</span><br><span class="line">        <span class="string">'model'</span>  =&gt; \App\User::class,</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">   <span class="string">'passwords'</span> =&gt; [</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">   ],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>é™¤äº†è¿™é‡Œï¼Œè¿˜éœ€è¦çœ‹ä¸€ä¸‹åŒ…æä¾›çš„é…ç½®ã€‚ç„¶ååˆ›å»ºä¸€ä¸ª <code>jwt.php</code> é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ã€‚ æœ€åæ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆç§˜é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan jwt:secret</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>é—¨é¢çš„æœåŠ¡é©±åŠ¨ä½¿ç”¨çš„ <code>eloquent</code>, æ‰€ä»¥éœ€è¦å®ç° <code>Tymon\JWTAuth\Contracts\JWTSubject</code> æ¥å£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span> <span class="keyword">implements</span> <span class="title">AuthenticatableContract</span>, <span class="title">AuthorizableContract</span>, <span class="title">JWTSubject</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Authenticatable</span>, <span class="title">Authorizable</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The attributes that are mass assignable.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> $fillable = [</span><br><span class="line">        <span class="string">'name'</span>, <span class="string">'email'</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The attributes excluded from the model's JSON form.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> $hidden = [</span><br><span class="line">        <span class="string">'password'</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Get the identifier that will be stored in the subject claim of the JWT.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getJWTIdentifier</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;getKey();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Return a key value array, containing any custom claims to be added to the JWT.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getJWTCustomClaims</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> [];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ <code>LoginController</code>ï¼Œå®ç°å¦‚ä¸‹:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Tymon</span>\<span class="title">JWTAuth</span>\<span class="title">JWTAuth</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">(Request $request, JWTAuth $jwt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (! $token = $jwt-&gt;attempt($request-&gt;only(<span class="string">'email'</span>, <span class="string">'password'</span>))) &#123;</span><br><span class="line"><span class="keyword">return</span> response()-&gt;json([<span class="string">'user_not_found'</span>], <span class="number">404</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response()-&gt;json(compact(<span class="string">'token'</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ è·¯ç”±</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$router-&gt;post(<span class="string">'login'</span>, <span class="string">'LoginController@login'</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¦è¯´ä¸€ä¸‹ï¼Œä½ çš„ <code>Users</code> è¡¨ç»“æ„å¯ä»¥ç›´æ¥ç”¨ <code>Laravel Auth</code>ï¼Œè®¤è¯å®é™…ä¹Ÿæ˜¯åŸºäº <code>Auth</code> å®ç°çš„ï¼Œæ‰€ä»¥è¿™ä¸€å—å¾ˆè½»æ¾ã€‚ æµ‹è¯•ç”¨ <code>Postman</code> è¯·æ±‚ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿”å›çš„ç»“æœã€‚åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"token"</span>: <span class="string">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9sb2NhbGhvc3Q6ODAwMFwvbG9naW4iLCJpYXQiOjE1NDI2ODExMzgsImV4cCI6MTU0MjY4NDczOCwibmJmIjoxNTQyNjgxMTM4LCJqdGkiOiJHZGp5bFV1ZlpHdzM2cTlPIiwic3ViIjo4LCJwcnYiOiI4N2UwYWYxZWY5ZmQxNTgxMmZkZWM5NzE1M2ExNGUwYjA0NzU0NmFhIn0.oZwsvsY8kfDvcs6ct_IGLzU8JWPDUbTTb6u8OTntsl4"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä¾¿æ˜¯è¯¥åŒ…ä½¿ç”¨çš„è¿‡ç¨‹ï¼Œå¦‚æœæœ‰ç–‘é—®æˆ–è€…é—æ¼ä¹‹å¤„è¯·æŒ‡æ­£ã€‚<a href="http://jwt-auth.com" target="_blank" rel="noopener">Jwt æ–‡æ¡£åœ°å€</a> </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘æƒ³æä¸€ä¸‹å‰åç«¯åˆ†ç¦»ï¼Œæ‰€ä»¥å°±åŸºäº Vue æƒ³åšä¸€ä¸‹åŸºç¡€çš„åå°ç®¡ç†ï¼Œåç«¯å°±é€‰ç”¨äº† Lumen5.7.*ï¼Œå› ä¸ºè§£å†³æ–¹æ¡ˆå¤šï¼Œæ–¹ä¾¿ã€‚è®¤è¯å°±åœ¨æ­¤åŸºç¡€ä½¿ç”¨äº† Json Web Token(JWT)ã€‚è¿™é‡Œè®°å½•ä¸€äº›ä½¿ç”¨è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ä¸‹è½½-Jwt-åŒ…&quot;&gt;&lt;a href=&quot;
      
    
    </summary>
    
    
      <category term="å·¥å…·ç¬”è®°" scheme="https://njphper.com/categories/%E5%B7%A5%E5%85%B7%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="jwt" scheme="https://njphper.com/tags/jwt/"/>
    
      <category term="lumen" scheme="https://njphper.com/tags/lumen/"/>
    
  </entry>
  
</feed>
